import Matrix from"../util/matrix.js";export default class LeastMedianSquaresRegression{constructor(t=5){this._w=null,this._k=t}fit(t,r){t=Matrix.fromArray(t),r=Matrix.fromArray(r);const s=t.resize(t.rows,t.cols+1,1),[o,e]=s.sample(this._k,0,!0),i=r.row(e),a=o.tDot(o).solve(o.tDot(i)),l=s.dot(a);l.sub(r),l.mult(l);const h=l.sum(1).value;h.sort(((t,r)=>t-r));const n=h.length%2==1?h[(h.length-1)/2]:(h[h.length/2-1]+h[h.length/2])/2;(!this._w||n<this._score)&&(this._w=a,this._score=n)}predict(t){return(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1).dot(this._w).toArray()}}