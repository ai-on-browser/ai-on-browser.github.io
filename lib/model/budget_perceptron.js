export default class BudgetPerceptron{constructor(t,s){this._beta=t,this._n=s,this._w=null,this._c=0,this._s=[]}fit(t,s){this._w||(this._w=Array(t[0].length).fill(0));for(let h=0;h<t.length;h++){if(t[h].reduce(((t,s,h)=>t+s*this._w[h]),this._c)*s[h]<=this._beta){for(let i=0;i<t[h].length;i++)this._w[i]+=s[h]*t[h][i];if(this._c+=s[h],this._n<=0)for(let t=this._s.length-1;t>=0;t--){const s=this._s[t];s.x.reduce(((t,h,i)=>t+h*(this._w[i]-s.y*s.x[i])),this._c-s.y)*s.y>this._beta||this._s.splice(t,1)}else if(this._s.length>=this._n){const t=this._s.map(((t,s)=>[s,t.x.reduce(((s,h,i)=>s+h*(this._w[i]-t.y*t.x[i])),this._c-t.y)*t.y]));t.sort(((t,s)=>s[1]-t[1])),this._s.splice(t[0][0],1)}this._s.push({x:t[h],y:s[h]})}}}predict(t){const s=[];for(let h=0;h<t.length;h++){const i=t[h].reduce(((t,s,h)=>t+s*this._w[h]),this._c);s.push(i<=0?-1:1)}return s}}