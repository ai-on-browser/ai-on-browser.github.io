import Matrix from"../util/matrix.js";export default class Winnow{constructor(t=2,i=null,s=1){this._alpha=t,this._th=this._th_org=i,this._v=s}init(t,i){this._x=Matrix.fromArray(t),this._y=i,this._epoch=0,null==this._th_org&&(this._th=this._x.rows/2),this._w=Matrix.ones(this._x.cols,1)}fit(){const t=this._x.dot(this._w);t.map((t=>t<=this._th?-1:1)),this._epoch++;for(let i=0;i<this._x.rows;i++)if(1===t.at(i,0)&&-1===this._y[i])for(let t=0;t<this._x.cols;t++)1===this._x.at(i,t)&&(1===this._v?this._w.set(t,0,0):this._w.divAt(t,0,this._alpha));else if(-1===t.at(i,0)&&1===this._y[i])for(let t=0;t<this._x.cols;t++)1===this._x.at(i,t)&&this._w.multAt(t,0,this._alpha)}predict(t){return Matrix.fromArray(t).dot(this._w).value.map((t=>t<=this._th?-1:1))}}