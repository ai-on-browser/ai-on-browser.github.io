import{Matrix}from"../util/math.js";export default class LpNormLinearRegression{constructor(t=2){this._p=t,this._b=null}fit(t,r){t=Matrix.fromArray(t),r=Matrix.fromArray(r),this._w||(this._w=Matrix.ones(t.rows,1));const s=t.copyMult(this._w);if(this._b=s.tDot(t).solve(s.tDot(r)),this._p-2!=0){const s=t.dot(this._b),i=r.copySub(s);i.map(Math.abs),this._w=i.sum(1),this._p-2<0?this._w.map((t=>Math.max(1e-8,t)**(this._p-2))):this._w.map((t=>t**(this._p-2)))}}predict(t){return(t=Matrix.fromArray(t)).dot(this._b).toArray()}}