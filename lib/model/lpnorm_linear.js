var e=Object.defineProperty;var _=(h,t)=>e(h,"name",{value:t,configurable:!0});import i from"../util/matrix.js";export default class l{static{_(this,"LpNormLinearRegression")}constructor(t=2){this._p=t,this._b=null}fit(t,o){t=i.fromArray(t),o=i.fromArray(o),this._w||(this._w=i.ones(t.rows,o.cols)),this._b||(this._b=i.zeros(t.cols,o.cols));for(let s=0;s<this._b.cols;s++){const r=i.mult(t,this._w.col(s)),a=r.tDot(t).solve(r.tDot(o.col(s)));this._b.set(0,s,a)}if(this._p-2!==0){const s=t.dot(this._b);this._w=i.sub(o,s),this._w.map(Math.abs),this._p-2<0?this._w.map(r=>Math.max(1e-8,r)**(this._p-2)):this._w.map(r=>r**(this._p-2))}}predict(t){return t=i.fromArray(t),t.dot(this._b).toArray()}}
