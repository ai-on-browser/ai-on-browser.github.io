var l=Object.defineProperty;var m=(a,i)=>l(a,"name",{value:i,configurable:!0});import _ from"../util/matrix.js";export default class f{static{m(this,"QuadraticDiscriminant")}constructor(){this._m=[],this._s=[],this._sinv=[],this._c=[],this._categories=[]}fit(i,h){this._m=[],this._s=[],this._sinv=[],this._c=[],this._categories=[];const c=i.length,r=new Set(h);for(const e of r){const n=[];for(let s=0;s<h.length;s++)h[s]===e&&n.push(i[s]);if(n.length===0)break;const t=_.fromArray(n);this._m.push(t.mean(0));const o=t.cov();this._s.push(o),this._sinv.push(o.inv()),this._c.push(Math.log(t.rows/c)-Math.log(o.det())/2),this._categories.push(e)}}predict(i){return i.map(h=>{const c=this._m.length,r=new _(1,h.length,h);let e=-1,n=-1/0;for(let t=0;t<c;t++){const o=_.sub(r,this._m[t]),s=this._c[t]-o.dot(this._sinv[t]).dot(o.t).toScaler()/2;n<s&&(n=s,e=t)}return this._categories[e]})}}
