import Matrix from"../util/matrix.js";export default class PA{constructor(t=0){this._c=.1,this._v=t}init(t,i){this._x=Matrix.fromArray(t),this._y=i,this._d=this._x.cols,this._w=Matrix.zeros(this._d,1),this._w0=0}update(t,i){const s=t.dot(this._w).toScaler()+this._w0;if(i*s>=1)return;const r=Math.max(0,1-i*s),h=t.norm()**2+1;let _=0;0===this._v?_=r/h:1===this._v?_=Math.min(this._c,r/h):2===this._v&&(_=r/(h+1/(2*this._c)));const o=t.t;o.mult(_*i),this._w.add(o),this._w0+=_*i}fit(){for(let t=0;t<this._x.rows;t++)this.update(this._x.row(t),this._y[t])}predict(t){return Matrix.fromArray(t).dot(this._w).value.map((t=>t+this._w0<=0?-1:1))}}