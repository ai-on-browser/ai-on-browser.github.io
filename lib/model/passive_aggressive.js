import{Matrix}from"../util/math.js";export default class PA{constructor(t=0){this._c=.1,this._v=t}init(t,s){this._x=Matrix.fromArray(t),this._m=this._x.mean(0),this._x.sub(this._m),this._y=s,this._d=this._x.cols,this._w=Matrix.zeros(this._d,1)}update(t,s){const i=t.dot(this._w).toScaler();if(s*i>=1)return;const h=Math.max(0,1-s*i),r=t.norm()**2;let _=0;0===this._v?_=h/r:1===this._v?_=Math.min(this._c,h/r):2===this._v&&(_=h/(r+1/(2*this._c)));const o=t.t;o.mult(_*s),this._w.add(o)}fit(){for(let t=0;t<this._x.rows;t++)this.update(this._x.row(t),this._y[t])}predict(t){const s=Matrix.fromArray(t);s.sub(this._m);return s.dot(this._w).value.map((t=>t<=0?-1:1))}}