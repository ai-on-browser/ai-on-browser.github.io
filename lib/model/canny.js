var _=Object.defineProperty;var u=(r,o)=>_(r,"name",{value:o,configurable:!0});export default class M{static{u(this,"Canny")}constructor(o,i){this._bigth=o,this._smlth=i}_convolute(o,i){const c=[];for(let n=0;n<o.length;n++){c[n]=[];for(let a=0;a<o[n].length;a++){let h=0;for(let s=0;s<i.length;s++){let t=n+s-Math.floor(i.length/2);t=Math.max(0,Math.min(o.length-1,t));for(let e=0;e<i[s].length;e++){let l=a+e-Math.floor(i[s].length/2);l=Math.max(0,Math.min(o[t].length-1,l)),h+=o[t][l]*i[s][e]}}c[n][a]=h}}return c}_gaussian(o){const i=[[.0625,.125,.0625],[.125,.25,.125],[.0625,.125,.0625]];return this._convolute(o,i)}predict(o){o=this._gaussian(o);const i=this._convolute(o,[[1,0,-1],[2,0,-2],[1,0,-1]]),c=this._convolute(o,[[1,2,1],[0,0,0],[-1,-2,-1]]),n=[],a=[];for(let t=0;t<i.length;t++){n[t]=[],a[t]=[];for(let e=0;e<i[t].length;e++)n[t][e]=Math.sqrt(i[t][e]**2+c[t][e]**2),a[t][e]=Math.atan2(c[t][e],i[t][e])*360/(2*Math.PI)}const h=[];for(let t=0;t<n.length;t++){h[t]=[];for(let e=0;e<n[t].length;e++){if(t===0||t===n.length-1||e===0||e===n[t].length-1){h[t][e]=0;continue}h[t][e]=n[t][e];const l=a[t][e];-22.5<=l&&l<22.5||157.5<=l||l<-157.5?(n[t][e]<n[t][e-1]||n[t][e]<n[t][e+1])&&(h[t][e]=0):22.5<=l&&l<67.5||-157.5<=l&&l<-112.5?(n[t][e]<n[t+1][e-1]||n[t][e]<n[t-1][e+1])&&(h[t][e]=0):67.5<=l&&l<112.5||-112.5<=l&&l<-67.5?(n[t][e]<n[t+1][e]||n[t][e]<n[t-1][e])&&(h[t][e]=0):(112.5<=l&&l<157.5||-67.5<=l&&l<-22.5)&&(n[t][e]<n[t+1][e+1]||n[t][e]<n[t-1][e-1])&&(h[t][e]=0)}}const s=[];for(let t=0;t<h.length;t++)s[t]=Array(h[t].length).fill(!1);for(let t=0;t<h.length;t++)for(let e=0;e<h[t].length;e++)if(h[t][e]>=this._bigth){const l=[[t,e]];for(;l.length>0;){const[f,g]=l.pop();f<0||h.length<=f||g<0||h[f].length<=g||s[f][g]||h[f][g]<this._smlth||(s[f][g]=!0,l.push([f+1,g],[f-1,g],[f,g+1],[f,g-1]))}}return s}}
