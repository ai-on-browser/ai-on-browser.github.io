import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class SplitLayer extends Layer{constructor({axis:s=1,size:t,...i}){super(i),this._axis=s,this._size=t}calc(s){let t=0;this._o=[];for(let i=0;i<this._size.length;i++)1===this._axis?this._o.push(s.sliceCol(t,t+this._size[i])):this._o.push(s.sliceRow(t,t+this._size[i])),t+=this._size[i];return this._o}grad(...s){for(let t=0;t<this._o.length;t++)s[t]||(s[t]=Matrix.zeros(this._o[t].rows,this._o[t].cols));let t=s[0];for(let i=1;i<s.length;i++)t=t.concat(s[i],this._axis);return t}}