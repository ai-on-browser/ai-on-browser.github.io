import Layer from"./base.js";export default class SparseLayer extends Layer{constructor({rho:t,beta:r,...h}){super(h),this._rho=t,this._beta=r}bind({rho:t}){this._rho=t||this._rho}calc(t){return this._rho_hat=t.mean(0),t}grad(t){const r=this._rho_hat.copyIdiv(-this._rho);return r.add(this._rho_hat.copyIsub(1).copyIdiv(1-this._rho)),r.mult(this._beta),t.copyAdd(r)}}