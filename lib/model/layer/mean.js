import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class MeanLayer extends Layer{constructor({axis:i=-1,...s}){super(s),this._axis=i}calc(i){return this._i=i,this._axis<0?new Matrix(1,1,i.mean()):i.mean(this._axis)}grad(i){if(this._axis<0)return new Matrix(this._i.rows,this._i.cols,i.toScaler()/this._i.length);const s=i.copyRepeat(this._i.sizes[this._axis],this._axis);return s.div(this._i.sizes[this._axis]),s}toObject(){return{type:"mean",axis:this._axis}}}MeanLayer.registLayer();