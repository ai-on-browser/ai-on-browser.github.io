import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class PReLULayer extends Layer{constructor({a:t=.01,...a}){super(a),this._a=t}calc(t){return this._i=t,this._o=this._i.copyMap((t=>t>0?t:this._a*t)),this._o}grad(t){this._bo=t;const a=this._i.copyMap((t=>t>0?1:this._a));return a.mult(t),a}update(){let t=0;for(let a=0;a<this._i.length;a++)this._i.value[a]<0&&(t+=this._bo.value[a]*this._i.value[a]);this._a-=this._opt.delta("a",Matrix.fromArray(t/this._i.length)).at(0,0)}get_params(){return{a:this._a}}set_params(t){this._a=t.a}}