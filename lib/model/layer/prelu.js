import Layer from"./base.js";export default class PReLULayer extends Layer{constructor({a:t=.25,...s}){super(s),this._a=t,this._da=0}calc(t){return this._i=t,this._o=this._i.copyMap((t=>t>0?t:this._a*t)),this._o}grad(t){this._bo=t;const s=this._i.copyMap((t=>t>0?1:this._a));return s.mult(t),s}update(){let t=0;for(let s=0;s<this._i.length;s++)this._i.value[s]<0&&(t+=this._bo.value[s]*this._i.value[s]);this._da=.1*this._da+this._opt.lr*t/this._i.length,this._a-=this._da}get_params(){return{a:this._a}}set_params(t){this._a=t.a}}