import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class PReLULayer extends Layer{constructor({a:t=.01,...a}){super(a),this._a=t}calc(t){return this._i=t,this._o=t.copyMap((t=>t>0?t:this._a*t)),this._o}grad(t){this._bo=t;const a=this._o.copyMap((t=>t>0?1:this._a));return a.mult(t),a}update(){const t=this._i.copyMult(this._bo);this._a-=this._opt.delta("a",Matrix.fromArray(t.mean())).at(0,0)}get_params(){return{a:this._a}}set_params(t){this._a=t.a}}