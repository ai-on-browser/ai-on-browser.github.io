import{Matrix}from"../../util/math.js";import Layer from"./base.js";export{default as Layer,LossLayer,FlowLayer}from"./base.js";const buildLayer=(o,a,r)=>{(class extends Layer{calc(o){return this._i=o,this._o=a(o),this._o}grad(o){const a=r(this._i,this._o);return a.mult(o),a}}).registLayer(o)},simpleLayers={abs:{calc:o=>o.copyMap(Math.abs),grad:(o,a)=>o.copyMap((o=>o<0?-1:1))},acos:{calc:o=>o.copyMap(Math.acos),grad:(o,a)=>o.copyMap((o=>-1/(Math.sqrt(1-o**2)+1e-4)))},acosh:{calc:o=>o.copyMap(Math.acosh),grad:(o,a)=>o.copyMap((o=>1/(Math.sqrt(o**2-1)+1e-4)))},asin:{calc:o=>o.copyMap(Math.asin),grad:(o,a)=>o.copyMap((o=>1/(Math.sqrt(1-o**2)+1e-4)))},asinh:{calc:o=>o.copyMap(Math.asinh),grad:(o,a)=>o.copyMap((o=>1/Math.sqrt(1+o**2)))},atan:{calc:o=>o.copyMap(Math.atan),grad:(o,a)=>o.copyMap((o=>1/(1+o**2)))},atanh:{calc:o=>o.copyMap(Math.atanh),grad:(o,a)=>o.copyMap((o=>1/(1-o**2)))},cos:{calc:o=>o.copyMap(Math.cos),grad:(o,a)=>o.copyMap((o=>-Math.sin(o)))},cosh:{calc:o=>o.copyMap(Math.cosh),grad:(o,a)=>o.copyMap(Math.sinh)},exp:{calc:o=>o.copyMap(Math.exp),grad:(o,a)=>a.copy()},log:{calc:o=>o.copyMap(Math.log),grad:(o,a)=>o.copyMap((o=>1/o))},negative:{calc:o=>o.copyMult(-1),grad:(o,a)=>new Matrix(1,1,-1)},relu:{calc:o=>o.copyMap((o=>o>0?o:0)),grad:(o,a)=>a.copyMap((o=>o>0?1:0))},sin:{calc:o=>o.copyMap(Math.sin),grad:(o,a)=>o.copyMap(Math.cos)},sinh:{calc:o=>o.copyMap(Math.sinh),grad:(o,a)=>o.copyMap(Math.cosh)},softsign:{calc:o=>o.copyMap((o=>o/(1+Math.abs(o)))),grad:(o,a)=>o.copyMap((o=>1/(1+Math.abs(o))**2))},sqrt:{calc:o=>o.copyMap(Math.sqrt),grad:(o,a)=>a.copyMap((o=>1/(2*o)))},square:{calc:o=>o.copyMult(o),grad:(o,a)=>o.copyMult(2)},tan:{calc:o=>o.copyMap(Math.tan),grad:(o,a)=>o.copyMap((o=>1/Math.cos(o)**2))},tanh:{calc:o=>o.copyMap(Math.tanh),grad:(o,a)=>a.copyMap((o=>1-o**2))}};for(const o of Object.keys(simpleLayers))buildLayer(o,simpleLayers[o].calc,simpleLayers[o].grad);export*from"./add.js";export*from"./additive_coupling.js";export*from"./argmax.js";export*from"./batch_normalization.js";export*from"./clip.js";export*from"./concat.js";export*from"./cond.js";export*from"./const.js";export*from"./conv.js";export*from"./detach.js";export*from"./div.js";export*from"./dropout.js";export*from"./elu.js";export*from"./flatten.js";export*from"./full.js";export*from"./gaussian.js";export*from"./gru.js";export*from"./huber.js";export*from"./include.js";export*from"./input.js";export*from"./leaky_relu.js";export*from"./less.js";export*from"./linear.js";export*from"./lstm.js";export*from"./matmul.js";export*from"./mean.js";export*from"./mse.js";export*from"./mult.js";export*from"./onehot.js";export*from"./output.js";export*from"./power.js";export*from"./prelu.js";export*from"./random.js";export*from"./reshape.js";export*from"./reverse.js";export*from"./rnn.js";export*from"./rrelu.js";export*from"./sigmoid.js";export*from"./softargmax.js";export*from"./softmax.js";export*from"./softplus.js";export*from"./sparse.js";export*from"./split.js";export*from"./sub.js";export*from"./sum.js";export*from"./supervisor.js";export*from"./transpose.js";export*from"./variable.js";export*from"./variance.js";