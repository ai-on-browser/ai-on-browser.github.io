import Layer from"./base.js";import Matrix from"../../util/matrix.js";export default class SubLayer extends Layer{calc(...e){this._sizes=e.map((e=>e.sizes));let r=e[0].copy();for(let s=1;s<e.length;s++)r.sub(e[s]);return r}grad(e){const r=e.copyMap((e=>-e));return this._sizes.map(((s,t)=>{const a=0===t?e:r;if(a.sizes.map(((e,r)=>e/s[r])).every((e=>1===e)))return a;const i=Matrix.zeros(s[0],s[1]);for(let e=0;e<a.sizes[0];e++)for(let r=0;r<a.sizes[1];r++)i.addAt(e%s[0],r%s[1],a.at(e,r));return i}))}}SubLayer.registLayer();