import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class SubLayer extends Layer{calc(...e){this._sizes=e.map((e=>e.sizes));let s=e[0].copy();for(let t=1;t<e.length;t++)s.sub(e[t]);return s}grad(e){const s=e.copyMap((e=>-e));return this._sizes.map(((t,r)=>{const a=0===r?e:s;if(a.sizes.map(((e,s)=>e/t[s])).every((e=>1===e)))return a;const i=Matrix.zeros(t[0],t[1]);for(let e=0;e<a.sizes[0];e++)for(let s=0;s<a.sizes[1];s++)i.addAt(e%t[0],s%t[1],a.at(e,s));return i}))}}