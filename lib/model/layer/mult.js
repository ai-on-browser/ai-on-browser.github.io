import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class MultLayer extends Layer{calc(...t){this._i=t;let e=t[0].copy();for(let r=1;r<t.length;r++)e.mult(t[r]);return e}grad(t){return this._i.map(((e,r)=>{const s=e.sizes,i=t.copy();for(let t=0;t<this._i.length;t++)r!==t&&i.mult(this._i[t]);if(i.sizes.map(((t,e)=>t/s[e])).every((t=>1===t)))return i;const a=Matrix.zeros(s[0],s[1]);for(let t=0;t<i.sizes[0];t++)for(let e=0;e<i.sizes[1];e++)a.addAt(t%s[0],e%s[1],i.at(t,e));return a}))}}