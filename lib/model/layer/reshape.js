import Layer from"./base.js";export default class ReshapeLayer extends Layer{constructor({size:s,...e}){super(e),this._size=s}calc(s){this._in_size=s.sizes.concat(),this._out_size=[s.sizes[0],...this._size];const e=2===this._out_size.length?s.copy():Tensor.fromArray(s.copy());return e.reshape(...this._out_size),e instanceof Tensor&&2===e.dimension?e.toMatrix():e}grad(s){let e=s.copy();return e instanceof Matrix&&this._in_size.length>2&&(e=Tensor.fromArray(e)),e.reshape(...this._in_size),e}}