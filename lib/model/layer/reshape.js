import Layer from"./base.js";import Tensor from"../../util/tensor.js";import Matrix from"../../util/matrix.js";export default class ReshapeLayer extends Layer{constructor({size:e,...s}){super(s),this._size=e}calc(e){this._in_size=e.sizes.concat(),this._out_size=[e.sizes[0],...this._size];const s=2===this._out_size.length?e.copy():Tensor.fromArray(e.copy());return s.reshape(...this._out_size),s instanceof Tensor&&2===s.dimension?s.toMatrix():s}grad(e){let s=e.copy();return s instanceof Matrix&&this._in_size.length>2&&(s=Tensor.fromArray(s)),s.reshape(...this._in_size),s}toObject(){return{type:"reshape",size:this._size}}}ReshapeLayer.registLayer();