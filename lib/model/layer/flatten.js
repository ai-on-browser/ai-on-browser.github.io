import Layer from"./base.js";import Tensor from"../../util/tensor.js";import Matrix from"../../util/matrix.js";export default class FlattenLayer extends Layer{calc(r){if(this._in_size=r.sizes.concat(),r instanceof Matrix)return r;const e=r.copy();return e.reshape(e.sizes[0],e.length/e.sizes[0]),e.toMatrix()}grad(r){if(2===this._in_size.length)return r;const e=Tensor.fromArray(r.copy());return e.reshape(...this._in_size),e}}FlattenLayer.registLayer();