import Layer from"./base.js";import{Matrix,Tensor}from"../../util/math.js";export default class FlattenLayer extends Layer{calc(e){if(this._in_size=e.sizes.concat(),e instanceof Matrix)return e;const r=e.copy();return r.reshape(r.sizes[0],r.length/r.sizes[0]),r.toMatrix()}grad(e){if(2===this._in_size.length)return e;const r=Tensor.fromArray(e.copy());return r.reshape(...this._in_size),r}}FlattenLayer.registLayer();