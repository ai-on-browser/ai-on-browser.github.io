import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class RReluLayer extends Layer{constructor({l:t=1/8,u:r=1/3,...s}){super(s),this._l=t,this._u=r,this._r=null}calc(t){this._r||(this._r=Matrix.random(1,t.cols,this._l,this._u)),this._i=t,this._o=t.copy();for(let r=0;r<t.rows;r++)for(let s=0;s<t.cols;s++)this._o.at(r,s)<0&&this._o.multAt(r,s,this._r.at(0,s));return this._o}grad(t){const r=t.copy();for(let t=0;t<r.rows;t++)for(let s=0;s<r.cols;s++)this._i.at(t,s)<0&&r.multAt(t,s,this._r.at(0,s));return r}get_params(){return{r:this._r}}set_params(t){this._r=t.r.copy()}}