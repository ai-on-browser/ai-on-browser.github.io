import Layer from"./base.js";import{Matrix}from"../../util/math.js";export default class AddLayer extends Layer{calc(...e){this._sizes=e.map((e=>e.sizes));let r=e[0].copy();for(let t=1;t<e.length;t++)r.add(e[t]);return r}grad(e){const r=e.sizes;return this._sizes.map((t=>{if(r.map(((e,r)=>e/t[r])).every((e=>1===e)))return e;const s=Matrix.zeros(t[0],t[1]);for(let a=0;a<r[0];a++)for(let i=0;i<r[1];i++)s.addAt(a%t[0],i%t[1],e.at(a,i));return s}))}}