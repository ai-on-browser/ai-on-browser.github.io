var o=Object.defineProperty;var d=(n,l)=>o(n,"name",{value:l,configurable:!0});export default class f{static{d(this,"ENaN")}constructor(l="euclid"){switch(this._p=[],this._c=[],this._metric=l,this._metric){case"euclid":this._d=(h,t)=>Math.sqrt(h.reduce((e,i,s)=>e+(i-t[s])**2,0));break;case"manhattan":this._d=(h,t)=>h.reduce((e,i,s)=>e+Math.abs(i-t[s]),0);break;case"chebyshev":this._d=(h,t)=>Math.max(...h.map((e,i)=>Math.abs(e-t[i])));break;case"minkowski":this._dp=2,this._d=(h,t)=>Math.pow(h.reduce((e,i,s)=>e+(i-t[s])**this._dp,0),1/this._dp);break}}fit(l,h){this._x=l,this._c=h,this._classes=[...new Set(this._c)],this._nears=[],this._n=Array(this._classes.length).fill(0);for(let t=0;t<this._x.length;t++){const e=this._x.map((i,s)=>({d:this._d(this._x[t],i),idx:s}));e.sort((i,s)=>i.d-s.d),this._nears[t]=e,this._n[this._classes.indexOf(this._c[t])]++}this._k=2;for(let t=2;t<this._x.length;t++){let e=!0;for(let i=0;i<this._nears.length&&e;i++){let s=!1;for(let _=1;_<t&&!s;_++){const c=this._nears[i][_].idx;for(let a=1;a<t&&!s;a++)s=this._nears[c][a].idx===i}e&&=s}if(e){this._k=t;break}}this._t=[];for(let t=0;t<this._classes.length;t++){let e=0;for(let i=0;i<this._nears.length;i++)if(this._c[i]===this._classes[t])for(let s=1;s<=this._k;s++)this._c[this._nears[i][s].idx]===this._classes[t]&&e++;this._t[t]=e/(this._n[t]*this._k)}}predict(l){const h=[];for(let t=0;t<l.length;t++)h[t]=this._predict(l[t]);return h}_predict(l){const h=[{d:0,idx:-1}],t=[];for(let s=0;s<this._x.length;s++){const _=this._d(l,this._x[s]);h.push({d:_,idx:s}),t[s]=_}h.sort((s,_)=>s.d-_.d);let e=-1/0,i=-1;for(let s=0;s<this._classes.length;s++){let _=0;for(let r=1;r<=this._k;r++)this._c[h[r].idx]===this._classes[s]&&_++;let c=0;for(let r=0;r<this._nears.length;r++)t[r]<this._nears[r][this._k].d&&c++;const a=c+_-this._k*this._t[s];e<a&&(e=a,i=s)}return this._classes[i]}}
