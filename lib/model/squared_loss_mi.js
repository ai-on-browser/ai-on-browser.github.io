import Matrix from"../util/matrix.js";export default class SquaredLossMICPD{constructor(t,i,e,s){this._model=t,this._window=i,this._take=e||Math.max(1,Math.floor(i/2)),this._lag=s||Math.max(1,Math.floor(this._take/2))}predict(t){const i=[];for(let e=0;e<t.length-this._window+1;e++)i.push(t.slice(e,e+this._window).flat());const e=[];for(let t=0;t<i.length-this._take-this._lag+1;t++){const s=Matrix.fromArray(i.slice(t,t+this._take)),l=Matrix.fromArray(i.slice(t+this._lag,t+this._take+this._lag));let h=0;this._model.fit(s,l);let o=this._model.predict(l);for(let t=0;t<o.length;t++)h+=(o[t]-1)**2/o.length;this._model.fit(l,s),o=this._model.predict(s);for(let t=0;t<o.length;t++)h+=(o[t]-1)**2/o.length;e.push(h)}return e}}