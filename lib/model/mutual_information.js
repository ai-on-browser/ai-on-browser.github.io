import Histogram from"./histogram.js";export default class MutualInformationFeatureSelection{constructor(){this._bins=40}_mutual_information(t,o){const i=new Histogram({count:this._bins}),n=i.fit(t),r=i.fit(o),e=i.fit(t.map(((t,i)=>[t[0],o[i][0]]))),s=t.length,a=o.length;let m=0;for(let t=0;t<n.length;t++)for(let o=0;o<r.length;o++)if(e[t][o]>0&&n[t]>0&&r[o]>0){const i=e[t][o]/s,l=n[t]/s,c=r[o]/a;m+=i*Math.log(i/(l*c))}return m/s}fit(t,o){const i=[];for(let n=0;n<t[0].length;n++){const r=t.map((t=>[t[n]]));i.push(this._mutual_information(r,o))}this._importance=i.map(((t,o)=>[t,o])),this._importance.sort(((t,o)=>o[0]-t[0]))}predict(t,o){const i=this._importance.slice(0,o).map((t=>t[1]));return t.map((t=>i.map((o=>t[o]))))}}