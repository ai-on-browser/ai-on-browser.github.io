import{Histogram}from"./histogram.js";export default class MutualInformationFeatureSelection{constructor(){}_mutual_information(t,o){const n=new Histogram({count:40}),i=n.fit(t),r=n.fit(o),e=n.fit(t.map(((t,n)=>[t[0],o[n][0]]))),a=t.length,m=o.length;let s=0;for(let t=0;t<i.length;t++)for(let o=0;o<r.length;o++)if(e[t][o]>0&&i[t]>0&&r[o]>0){const n=e[t][o]/a,l=i[t]/a,c=r[o]/m;s+=Math.log(n/(l*c))}return s/a}fit(t,o){const n=[];for(let i=0;i<t[0].length;i++){const r=t.map((t=>[t[i]]));n.push(this._mutual_information(r,o))}this._importance=n.map(((t,o)=>[t,o])),this._importance.sort(((t,o)=>o[0]-t[0]))}predict(t,o){const n=this._importance.slice(0,o).map((t=>t[1]));return t.map((t=>n.map((o=>t[o]))))}}