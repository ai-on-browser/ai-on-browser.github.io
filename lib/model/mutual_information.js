var g=Object.defineProperty;var l=(m,o)=>g(m,"name",{value:o,configurable:!0});import b from"./histogram.js";export default class d{static{l(this,"MutualInformationFeatureSelection")}constructor(){this._bins=40}_mutual_information(o,e){const i=new b({count:this._bins}),t=i.fit(o),n=i.fit(e),r=i.fit(o.map((s,a)=>[s[0],e[a][0]])),c=o.length,f=e.length;let p=0;for(let s=0;s<t.length;s++)for(let a=0;a<n.length;a++)if(r[s][a]>0&&t[s]>0&&n[a]>0){const h=r[s][a]/c,u=t[s]/c,_=n[a]/f;p+=h*Math.log(h/(u*_))}return p/c}fit(o,e){const i=[];for(let t=0;t<o[0].length;t++){const n=o.map(r=>[r[t]]);i.push(this._mutual_information(n,e))}this._importance=i.map((t,n)=>[t,n]),this._importance.sort((t,n)=>n[0]-t[0])}predict(o,e){const i=this._importance.slice(0,e).map(t=>t[1]);return o.map(t=>i.map(n=>t[n]))}}
