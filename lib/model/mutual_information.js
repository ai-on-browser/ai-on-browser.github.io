var g=Object.defineProperty;var l=(m,n)=>g(m,"name",{value:n,configurable:!0});import b from"./histogram.js";export default class d{static{l(this,"MutualInformationFeatureSelection")}constructor(n){this._k=n,this._bins=40}_mutual_information(n,e){const i=new b({count:this._bins}),t=i.fit(n),o=i.fit(e),r=i.fit(n.map((s,a)=>[s[0],e[a][0]])),c=n.length,f=e.length;let h=0;for(let s=0;s<t.length;s++)for(let a=0;a<o.length;a++)if(r[s][a]>0&&t[s]>0&&o[a]>0){const p=r[s][a]/c,u=t[s]/c,_=o[a]/f;h+=p*Math.log(p/(u*_))}return h/c}fit(n,e){const i=[];for(let t=0;t<n[0].length;t++){const o=n.map(r=>[r[t]]);i.push(this._mutual_information(o,e))}this._importance=i.map((t,o)=>[t,o]),this._importance.sort((t,o)=>o[0]-t[0])}predict(n){const e=this._importance.slice(0,this._k).map(i=>i[1]);return n.map(i=>e.map(t=>i[t]))}}
