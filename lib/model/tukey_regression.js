import{Matrix}from"../util/math.js";export default class TukeyRegression{constructor(t){this._e=t,this._w=null}fit(t,s){const o=(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1);s=Matrix.fromArray(s),this._w||(this._w=o.tDot(o).solve(o.tDot(s)));const r=o.dot(this._w);r.sub(s),r.map((t=>Math.abs(t)<=this._e?((1-t**2)/this._e**2)**2:0));for(let t=0;t<this._w.cols;t++){const i=o.copyMult(r.col(t)),e=i.tDot(o).solve(i.tDot(s.col(t)));this._w.set(0,t,e)}}predict(t){return(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1).dot(this._w).toArray()}}