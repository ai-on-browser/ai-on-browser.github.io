import{KMeans}from"./kmeans.js";export default class NeuralGas extends KMeans{constructor(t=1,s=.99){super(),this._l=t,this._eps=1,this._epoch=0,this._sample_rate=.8,this._m=s}move(t,s,e){const r=e.filter((t=>Math.random()<this._sample_rate));this._epoch++;const a=s,h=r.map((t=>{let s=a.map(((s,e)=>[e,this._distance(t,s)]));return s.sort(((t,s)=>t[1]-s[1])),s=s.map(((t,s)=>[t[0],t[1],s])),s.sort(((t,s)=>t[0]-s[0])),s}));return this._l*=this._m,a.map(((t,s)=>{const e=Array(r[0].length).fill(0);for(let a=0;a<r.length;a++)for(let l=0;l<r[a].length;l++)e[l]+=(r[a][l]-t[l])*this._eps*Math.exp(-h[a][s][2]/this._l);return e.map(((s,e)=>t[e]+s/r.length))}))}}