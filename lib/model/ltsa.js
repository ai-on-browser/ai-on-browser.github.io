var w=Object.defineProperty;var b=(A,e)=>w(A,"name",{value:e,configurable:!0});import k from"../util/matrix.js";export default class G{static{b(this,"LTSA")}constructor(e=1){this._k=e}predict(e,v=0){e=k.fromArray(e);const g=e.cols,l=e.rows,a=[];for(let o=0;o<l;o++){a[o]=[];for(let t=0;t<o;t++){let s=0;for(let r=0;r<g;r++)s+=(e.at(o,r)-e.at(t,r))**2;a[o][t]=a[t][o]=s}}const i=[];for(let o=0;o<l;o++){const t=[];for(let s=0;s<l;s++){if(s===o)continue;const r=a[o][s];if(t.length<this._k||r<t[this._k-1].dt){t.length===this._k&&t.pop(),t.push({dt:r,idx:s});for(let n=t.length-1;n>0;n--)t[n].dt<t[n-1].dt&&([t[n],t[n-1]]=[t[n-1],t[n]])}}i.push([o,...t.map(s=>s.idx)])}const f=k.zeros(l,l);for(let o=0;o<l;o++){const t=e.row(i[o]),s=t.mean(0);t.sub(s);const n=t.dot(t.t).eigenVectors(),p=new k(i[o].length,g+1,1/Math.sqrt(i[o].length));p.set(0,1,n.slice(0,g,1));const u=p.dot(p.t);for(let c=0;c<i[o].length;c++){const h=i[o][c];f.addAt(h,h,1+u.at(c,c));for(let d=0;d<c;d++){const _=i[o][d];f.addAt(h,_,u.at(c,d)),f.addAt(_,h,u.at(d,c))}}}const m=f.eigenVectors();return m.flip(1),m.slice(1,v+1,1).toArray()}}
