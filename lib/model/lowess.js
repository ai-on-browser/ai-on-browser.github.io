import{Matrix}from"../util/math.js";export default class LOWESS{constructor(){this._k=(t,r)=>{const s=t.copySub(r);s.map((t=>t*t));const o=s.sum(1);return o.map((t=>t<=1?(1-Math.sqrt(t)**3)**3:0)),o}}fit(t,r){this._x=Matrix.fromArray(t),this._b=this._x.resize(this._x.rows,this._x.cols+1,1),this._y=Matrix.fromArray(r)}predict(t){t=Matrix.fromArray(t);const r=[];for(let s=0;s<t.rows;s++){const o=t.row(s),i=this._k(this._x,o),h=this._b.copyMult(i),a=h.tDot(this._b).solve(h.tDot(this._y));r.push(o.resize(o.rows,o.cols+1,1).dot(a).value)}return r}}