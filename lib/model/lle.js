import{Matrix}from"../util/math.js";const LLE=function(t,e=1,o=0){const r=(t=Matrix.fromArray(t)).cols,l=t.rows,f=[];for(let t=0;t<l;f[t++]=[]);for(let e=0;e<l;e++)for(let o=0;o<e;o++){let l=0;for(let f=0;f<r;f++)l+=(t.at(e,f)-t.at(o,f))**2;f[e][o]=f[o][e]=l}const i=[];for(let t=0;t<l;t++){let o=[];for(let r=0;r<l;r++){if(r===t)continue;let l=f[t][r];if(o.length<e||l<o[e-1].dt){o.length===e&&o.pop(),o.push({dt:l,idx:r});for(let t=o.length-1;t>0;t--)o[t].dt<o[t-1].dt&&([o[t],o[t-1]]=[o[t-1],o[t]])}}i.push(o)}const s=Matrix.eye(l,l);for(let o=0;o<l;o++){let r=i[o].map((t=>t.idx)),l=t.row(r);l.sub(t.row(o));let f=l.dot(l.t).inv().sum(0);f.div(f.sum());for(let t=0;t<e;t++)s.subAt(o,r[t],f.value[t])}let n=s.tDot(s).eigenVectors();return n.flip(1),n.sliceCol(1,o+1).toArray()};export default LLE;