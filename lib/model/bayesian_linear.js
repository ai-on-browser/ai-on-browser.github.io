var c=Object.defineProperty;var l=(a,t)=>c(a,"name",{value:t,configurable:!0});import i from"../util/matrix.js";export default class m{static{l(this,"BayesianLinearRegression")}constructor(t=.1,s=.2){this._w=null,this._lambda=t,this._sigma=s,this._m=null,this._s=null,this._beta=1/s**2,this._alpha=t*this._beta}_init(t,s){this._m=i.zeros(t.cols+1,s.cols),this._s=i.eye(t.cols+1,t.cols+1,1/this._alpha)}fit(t,s){t=i.fromArray(t),s=i.fromArray(s),this._m||this._init(t,s);const n=i.resize(t,t.rows,t.cols+1,1);for(let o=0;o<t.rows;o++){const r=n.row(o),e=this._s.inv(),h=r.tDot(r);h.mult(this._beta),h.add(e),this._s=h.inv();const _=r.tDot(s.row(o));_.mult(this._beta),_.add(e.dot(this._m)),this._m=this._s.dot(_)}this._w=this._m}predict(t){return t=i.fromArray(t),i.resize(t,t.rows,t.cols+1,1).dot(this._w).toArray()}}
