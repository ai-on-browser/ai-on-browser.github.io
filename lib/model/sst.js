import{Matrix}from"../util/math.js";export default class SST{constructor(t,s,i){this._window=t,this._take=s||Math.max(1,Math.floor(t/2)),this._lag=i||Math.max(1,Math.floor(this._take/2))}predict(t){const s=[];for(let i=0;i<t.length-this._window+1;i++)s.push(t.slice(i,i+this._window));const i=[],a=Math.min(2,this._take),h=[];for(let t=0;t<a;h.push(t++));for(let t=0;t<s.length-this._take-this._lag+1;t++){const a=Matrix.fromArray(s.slice(t,t+this._take)).t,o=Matrix.fromArray(s.slice(t+this._lag,t+this._take+this._lag)).t,[r]=a.svd(),l=r.col(h),[e]=o.svd(),_=e.col(h),c=1-l.tDot(_).svd()[1][0]**2;i.push(c)}return i}}