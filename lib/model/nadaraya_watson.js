var d=Object.defineProperty;var _=(m,s)=>d(m,"name",{value:s,configurable:!0});import u from"../util/matrix.js";export default class M{static{_(this,"NadarayaWatson")}constructor(s){this._s=s,this._p=c=>{const n=Math.sqrt(2*Math.PI*this._s)**c.cols,h=u.mult(c,c).sum(1);return h.map(a=>Math.exp(-a/this._s)/n),h}}fit(s,c){if(this._y=c,!this._s){const n=s.length,o=s.map(r=>Math.sqrt(r.reduce((t,i)=>t+i**2,0))),h=o.reduce((r,t)=>r+t,0)/n,a=Math.sqrt(o.reduce((r,t)=>r+(t-h)**2,0)/n);o.sort((r,t)=>r-t);const e=_(r=>{const t=(n-1)*r,i=Math.floor(t),l=Math.ceil(t);return o[i]+(t-i)*(o[l]-o[i])},"q"),p=1.06*Math.min(a,(e(.75)-e(.25))/1.34)/n**.2;this._s=p**2}this._x=u.fromArray(s)}predict(s){const c=this._x.rows;return s.map(n=>{const o=u.sub(this._x,new u(1,n.length,n)),h=this._p(o);let a=0;for(let e=0;e<c;e++)a+=this._y[e][0]*h.value[e];return a/h.sum()})}}
