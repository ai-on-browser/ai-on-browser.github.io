var x=Object.defineProperty;var u=(b,l)=>x(b,"name",{value:l,configurable:!0});class g{static{u(this,"KMeans")}constructor(l,n){this._x=l,this._k=n;const _=this._x.length,h=[];for(let i=0;i<this._k;i++)h.push(Math.floor(Math.random()*(_-i)));for(let i=h.length-1;i>=0;i--)for(let t=h.length-1;t>i;t--)h[i]<=h[t]&&h[t]++;this._c=h.map(i=>this._x[i]),this._d=(i,t)=>Math.sqrt(i.reduce((s,e,c)=>s+(e-t[c])**2,0))}get c(){return this._c}fit(){const l=this.predict(),n=this._c.map(i=>Array.from(i,()=>0)),_=Array(this._k).fill(0),h=this._x.length;for(let i=0;i<h;i++){for(let t=0;t<this._x[i].length;t++)n[l[i]][t]+=this._x[i][t];_[l[i]]++}for(let i=0;i<this._k;i++)this._c[i]=n[i].map(t=>t/_[i])}predict(){const l=[],n=this._x.length;for(let _=0;_<n;_++){let h=1/0;l[_]=-1;for(let i=0;i<this._k;i++){const t=this._d(this._x[_],this._c[i]);t<h&&(h=t,l[_]=i)}}return l}}export default class m{static{u(this,"YinyangKMeans")}constructor(l,n){this._k=l,this._t=Math.max(1,n??Math.floor(this._k/10)),this._c=null,this._d=(_,h)=>Math.sqrt(_.reduce((i,t,s)=>i+(t-h[s])**2,0))}get centroids(){return this._c}init(l){this._x=l;const n=new g(this._x,this._k),_=new g(n.c,this._t);for(let t=0;t<5;t++)_.fit();const h=_.predict();this._g=Array.from({length:this._t},()=>[]);for(let t=0;t<h.length;t++)this._g[h[t]].push(t);n.fit(),this._c=n.c,this._b=n.predict(),this._ub=[],this._lb=[];const i=this._x.length;for(let t=0;t<i;t++){this._ub[t]=this._d(this._x[t],this._c[this._b[t]]),this._lb[t]=[];for(let s=0;s<this._t;s++){this._lb[t][s]=1/0;for(let e=0;e<this._g[s].length;e++){if(this._g[s][e]===this._b[t])continue;const c=this._d(this._x[t],this._c[this._g[s][e]]);c<this._lb[t][s]&&(this._lb[t][s]=c)}}}}fit(){const l=this._x.length,n=this._c.map(t=>Array.from(t,()=>0)),_=Array(this._k).fill(0);for(let t=0;t<l;t++){for(let s=0;s<this._x[t].length;s++)n[this._b[t]][s]+=this._x[t][s];_[this._b[t]]++}const h=[];for(let t=0;t<this._k;t++)n[t]=n[t].map(s=>s/_[t]),h[t]=this._d(this._c[t],n[t]),this._c[t]=n[t];const i=[];for(let t=0;t<this._t;t++){i[t]=0;for(let s=0;s<this._g[t].length;s++)i[t]=Math.max(i[t],h[this._g[t][s]])}for(let t=0;t<l;t++){this._ub[t]+=h[this._b[t]];const s=[];let e=1/0;for(let o=0;o<this._t;o++)s[o]=this._lb[t][o],this._lb[t][o]-=i[o],e=Math.min(e,this._lb[t][o]);const c=this._b[t];if(e>=this._ub[t]||(this._ub[t]=this._d(this._x[t],this._c[this._b[t]]),e>=this._ub[t]))continue;const a=[];for(let o=0;o<this._t;o++)if(!(this._lb[t][o]>=this._ub[t])){a.push(o),this._lb[t][o]=1/0;for(const r of this._g[o]){if(c===r||this._lb[t][o]<s[o]-h[r])continue;const f=this._d(this._x[t],this._c[r]);if(f<this._ub[t]){let d=0;for(;!this._g[d].includes(this._b[t]);d++);this._lb[t][d]=this._ub[t],this._ub[t]=f,this._b[t]=r}else f<this._lb[t][o]&&(this._lb[t][o]=f)}}}}predict(l){const n=[];for(let _=0;_<l.length;_++){let h=1/0;n[_]=-1;for(let i=0;i<this._c.length;i++){const t=this._d(l[_],this._c[i]);t<h&&(h=t,n[_]=i)}}return n}}
