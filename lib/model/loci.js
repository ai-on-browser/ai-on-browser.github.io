export class LOCI{constructor(t=.5){this._alpha=t,this._rmax=1/0,this._nmin=20,this._ks=3}_distance(t,r){return Math.sqrt(t.reduce(((t,s,e)=>t+(s-r[e])**2),0))}predict(t){const r=t.length,s=[];for(let e=0;e<r;e++){s[e]=[],s[e][e]={d:0,i:e};for(let r=0;r<e;r++){const o=this._distance(t[e],t[r]);s[e][r]={d:o,i:r},s[r][e]={d:o,i:e}}}for(let t=0;t<r;t++)s[t].sort(((t,r)=>t.d-r.d));const e=Array(r).fill(!1);for(let t=0;t<r;t++){const o=s[t].filter((t=>t.d<=this._rmax));for(let i=Math.min(this._nmin,Math.floor(o.length/2));i<o.length;i++){const n=o[i].d,h=i+1,l=[];for(let t=0;t<=i;t++){l[t]=0;const e=this._alpha*n;let i=r,h=0;for(;h<i;){const r=Math.floor((i+h)/2);s[o[t].i][r].d<=e?h=r+1:i=r}l[t]=h}const c=l.reduce(((t,r)=>t+r),0)/h,a=Math.sqrt(l.reduce(((t,r)=>t+(r-c)**2),0)/h),d=1-l[0]/c,f=a/c;if(d>this._ks*f){e[t]=!0;break}}}return e}}