import{QTableBase}from"./q_learning.js";class SARSATable extends QTableBase{constructor(t,a=20,s=.2,e=.99){super(t,a),this._alpha=s,this._gamma=e}update(t,a,s,e,_){t=this._action_index(t),a=this._state_index(a),s=this._action_index(s),e=this._state_index(e);const[i]=this._q(e,s),[h,l]=this._q(a,t);this._table[l]+=this._alpha*(_+this._gamma*i-h)}}export default class SARSAAgent{constructor(t,a=20){this._table=new SARSATable(t,a)}reset(){this._last_action=null}get_score(t){return this._table.toArray()}get_action(t,a,s=.002){return Math.random()>s?this._table.best_action(a):t.sample_action(this)}update(t,a,s,e){this._last_action&&this._table.update(this._last_action,this._last_state,t,a,this._last_reward),this._last_action=t,this._last_state=a,this._last_reward=e}}