var o=Object.defineProperty;var i=(e,t)=>o(e,"name",{value:t,configurable:!0});import"../rl/base.js";import{QTableBase as c}from"./q_learning.js";class u extends c{static{i(this,"SARSATable")}constructor(t,s=20,_=.2,a=.99){super(t,s),this._alpha=_,this._gamma=a}update(t,s,_,a,h){t=this._action_index(t),s=this._state_index(s),_=this._action_index(_),a=this._state_index(a);const[l]=this._q(a,_),[r,n]=this._q(s,t);this._table[n]+=this._alpha*(h+this._gamma*l-r)}}export default class d{static{i(this,"SARSAAgent")}constructor(t,s=20){this._env=t,this._table=new u(t,s)}reset(){this._last_action=null}get_score(){return this._table.toArray()}get_action(t,s=.002){return Math.random()>s?this._table.best_action(t):this._env.sample_action(this)}update(t,s,_,a){this._last_action&&this._table.update(this._last_action,this._last_state,t,s,this._last_reward),this._last_action=t,this._last_state=s,this._last_reward=a}}
