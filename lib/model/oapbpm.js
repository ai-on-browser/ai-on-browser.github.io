var g=Object.defineProperty;var o=(b,i)=>g(b,"name",{value:i,configurable:!0});export default class a{static{o(this,"OAPBPM")}constructor(i,s,h=.1){this._n=i,this._tau=s,this._wh=null,this._w=[],this._a=h,this._bh=[0,1/0],this._b=Array.from({length:i},()=>[0,1/0]),this._min=1}fit(i,s){if(!this._wh)for(let h=0;h<this._n;h++)this._w[h]=Array(i[0].length).fill(0);for(let h=0;h<i.length;h++){if(s[h]<this._min){for(let t=0;t<this._b.length;t++)this._b[t].splice(0,0,...Array(this._min-s[h]).fill(this._b[t][0]));this._min=s[h]}else if(s[h]>=this._min+this._b[0].length)for(let t=0;t<this._b.length;t++)this._b[t].splice(this._b[t].length-1,0,...Array(s[h]-(this._min+this._b[t].length)+1).fill(this._b[t][this._b[t].length-2]));for(let t=0;t<this._n;t++){const l=this._w[t].reduce((n,_,r)=>n+_*i[h][r],0);let e=0;for(;e<this._b[t].length&&!(l-this._b[t][e]<0);e++);const f=e+this._min;if(Math.random()<this._tau&&s[h]!==f){let n=0;for(let _=0;_<this._b[t].length-1;_++){const r=s[h]<=_+this._min?-1:1;(l-this._b[t][_])*r<=0&&(n+=r,this._b[t][_]-=this._a*r)}for(let _=0;_<this._w[t].length;_++)this._w[t][_]+=this._a*n*i[h][_]}}}this._wh=Array(this._w[0].length).fill(0),this._bh=Array(this._b[0].length).fill(0);for(let h=0;h<this._n;h++){for(let t=0;t<this._wh.length;t++)this._wh[t]+=this._w[h][t]/this._n;for(let t=0;t<this._bh.length;t++)this._bh[t]+=this._b[h][t]/this._n}}predict(i){const s=[];for(let h=0;h<i.length;h++){const t=this._wh.reduce((e,f,n)=>e+f*i[h][n],0);let l=0;for(;l<this._bh.length&&!(t-this._bh[l]<0);l++);s[h]=l+this._min}return s}}
