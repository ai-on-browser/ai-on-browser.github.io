import{onnx as e}from"../onnx_exporter.js";import{getConstNodeName as p}from"../utils.js";export default{export(n,d){const G=Array.isArray(d.input)?d.input[0]:d.input,S=n.getOpsetImportList()[0];if(S.getDomain()===""&&S.getVersion()>=20){const a=new e.NodeProto;a.setOpType("Gelu"),a.addInput(G),a.addOutput(d.name),n.getGraph().addNode(a)}else{const a=p(n,1),v=p(n,2),C=p(n,.3275911),E=p(n,.254829592),L=p(n,-.284496736),R=p(n,1.421413741),V=p(n,-1.453152027),k=p(n,1.061405429),A=new e.NodeProto;A.setOpType("Sqrt"),A.addInput(v),A.addOutput(`${d.name}_sqrt2`);const u=new e.NodeProto;u.setOpType("Div"),u.addInput(G),u.addInput(`${d.name}_sqrt2`),u.addOutput(`${d.name}_v`);const M=new e.NodeProto;M.setOpType("Abs"),M.addInput(`${d.name}_v`),M.addOutput(`${d.name}_abs`);const o=new e.NodeProto;o.setOpType("Mul"),o.addInput(`${d.name}_abs`),o.addInput(C),o.addOutput(`${d.name}_mul_p`);const _=new e.NodeProto;_.setOpType("Add"),_.addInput(`${d.name}_mul_p`),_.addInput(a),_.addOutput(`${d.name}_add1`);const x=new e.NodeProto;x.setOpType("Reciprocal"),x.addInput(`${d.name}_add1`),x.addOutput(`${d.name}_t`);const s=new e.NodeProto;s.setOpType("Mul"),s.addInput(`${d.name}_t`),s.addInput(k),s.addOutput(`${d.name}_mul_a5`);const m=new e.NodeProto;m.setOpType("Add"),m.addInput(`${d.name}_mul_a5`),m.addInput(V),m.addOutput(`${d.name}_add_a4`);const r=new e.NodeProto;r.setOpType("Mul"),r.addInput(`${d.name}_add_a4`),r.addInput(`${d.name}_t`),r.addOutput(`${d.name}_mul_a4`);const N=new e.NodeProto;N.setOpType("Add"),N.addInput(`${d.name}_mul_a4`),N.addInput(R),N.addOutput(`${d.name}_add_a3`);const $=new e.NodeProto;$.setOpType("Mul"),$.addInput(`${d.name}_add_a3`),$.addInput(`${d.name}_t`),$.addOutput(`${d.name}_mul_a3`);const O=new e.NodeProto;O.setOpType("Add"),O.addInput(`${d.name}_mul_a3`),O.addInput(L),O.addOutput(`${d.name}_add_a2`);const I=new e.NodeProto;I.setOpType("Mul"),I.addInput(`${d.name}_add_a2`),I.addInput(`${d.name}_t`),I.addOutput(`${d.name}_mul_a2`);const c=new e.NodeProto;c.setOpType("Add"),c.addInput(`${d.name}_mul_a2`),c.addInput(E),c.addOutput(`${d.name}_add_a1`);const w=new e.NodeProto;w.setOpType("Mul"),w.addInput(`${d.name}_add_a1`),w.addInput(`${d.name}_t`),w.addOutput(`${d.name}_mul_a1`);const y=new e.NodeProto;y.setOpType("Pow"),y.addInput(`${d.name}_v`),y.addInput(v),y.addOutput(`${d.name}_pow`);const h=new e.NodeProto;h.setOpType("Neg"),h.addInput(`${d.name}_pow`),h.addOutput(`${d.name}_neg`);const q=new e.NodeProto;q.setOpType("Exp"),q.addInput(`${d.name}_neg`),q.addOutput(`${d.name}_exp`);const l=new e.NodeProto;l.setOpType("Mul"),l.addInput(`${d.name}_mul_a1`),l.addInput(`${d.name}_exp`),l.addOutput(`${d.name}_mul`);const P=new e.NodeProto;P.setOpType("Sub"),P.addInput(a),P.addInput(`${d.name}_mul`),P.addOutput(`${d.name}_erf`);const D=new e.NodeProto;D.setOpType("Sign"),D.addInput(`${d.name}_v`),D.addOutput(`${d.name}_sign`);const T=new e.NodeProto;T.setOpType("Mul"),T.addInput(`${d.name}_erf`),T.addInput(`${d.name}_sign`),T.addOutput(`${d.name}_sign_erf`);const i=new e.NodeProto;i.setOpType("Add"),i.addInput(a),i.addInput(`${d.name}_sign_erf`),i.addOutput(`${d.name}_erf_add1`);const g=new e.NodeProto;g.setOpType("Mul"),g.addInput(G),g.addInput(`${d.name}_erf_add1`),g.addOutput(`${d.name}_mul_v`);const f=new e.NodeProto;f.setOpType("Div"),f.addInput(`${d.name}_mul_v`),f.addInput(v),f.addOutput(d.name);const t=n.getGraph();t.addNode(A),t.addNode(u),t.addNode(M),t.addNode(o),t.addNode(_),t.addNode(x),t.addNode(s),t.addNode(m),t.addNode(r),t.addNode(N),t.addNode($),t.addNode(O),t.addNode(I),t.addNode(c),t.addNode(w),t.addNode(y),t.addNode(h),t.addNode(q),t.addNode(l),t.addNode(P),t.addNode(D),t.addNode(T),t.addNode(i),t.addNode(g),t.addNode(f)}}};
