import{onnx as n}from"../onnx_exporter.js";export default{export(x,t,c){const d=x.getGraph(),u=Array.isArray(t.input)?t.input[0]:t.input,e=new n.NodeProto;e.setOpType("ReduceProd"),e.addInput(u),e.addOutput(t.name);const p=t.keepdims??!0?1:0,a=new n.AttributeProto;a.setName("keepdims"),a.setType(n.AttributeProto.AttributeType.INT),a.setI(p),e.addAttribute(a),d.addNode(e);const o=c[u].size.concat();if(typeof t.axis=="string")throw new Error("Unsupported axis type string");if(t.axis==null||typeof t.axis=="number"&&t.axis<0)return{size:p?Array(o.length).fill(1):[]};const s=Array.isArray(t.axis)?t.axis:[t.axis],r=new n.TensorProto;if(r.setName(`${t.name}_axis`),r.setDataType(n.TensorProto.DataType.INT64),r.setDimsList([s.length]),r.setInt64DataList(s),d.addInitializer(r),e.addInput(`${t.name}_axis`),s.sort((i,m)=>m-i),p)for(const i of s)o[i]=1;else for(const i of s)o.splice(i,1);return{size:o}}};
