import{onnx as e}from"../onnx_exporter.js";import{getConstNodeName as N}from"../utils.js";export default{export(_,t){const T=N(_,0),d=new e.TensorProto;d.setName(`${t.name}_k`),d.setDataType(e.TensorProto.DataType.FLOAT),d.setDimsList([1]),d.setFloatDataList([t.k??1]);const n=new e.TensorProto;n.setName(`${t.name}_beta`),n.setDataType(e.TensorProto.DataType.FLOAT),n.setDimsList([1]),n.setFloatDataList([t.beta??1]);const l=Array.isArray(t.input)?t.input[0]:t.input,m=new e.NodeProto;m.setOpType("Relu"),m.addInput(l),m.addOutput(`${t.name}_relu`);const o=new e.NodeProto;o.setOpType("Mul"),o.addInput(`${t.name}_relu`),o.addInput(`${t.name}_k`),o.addOutput(`${t.name}_p`);const p=new e.NodeProto;p.setOpType("Min"),p.addInput(l),p.addInput(T),p.addOutput(`${t.name}_min`);const s=new e.NodeProto;s.setOpType("Mul"),s.addInput(`${t.name}_min`),s.addInput(`${t.name}_beta`),s.addOutput(`${t.name}_mul`);const u=new e.NodeProto;u.setOpType("Elu"),u.addInput(`${t.name}_mul`),u.addOutput(`${t.name}_elu`);const i=new e.AttributeProto;i.setName("alpha"),i.setType(e.AttributeProto.AttributeType.FLOAT),i.setF(t.alpha??1),u.addAttribute(i);const r=new e.NodeProto;r.setOpType("Add"),r.addInput(`${t.name}_p`),r.addInput(`${t.name}_elu`),r.addOutput(t.name);const a=_.getGraph();a.addInitializer(d),a.addInitializer(n),a.addNode(m),a.addNode(o),a.addNode(p),a.addNode(s),a.addNode(u),a.addNode(r)}};
