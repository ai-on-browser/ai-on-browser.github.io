var m=Object.defineProperty;var p=(n,t)=>m(n,"name",{value:t,configurable:!0});import c from"../../../util/matrix.js";export class RMSPropGravesOptimizer{static{p(this,"RMSPropGravesOptimizer")}constructor(t=1e-4,a=.95){this._learningrate=t,this._beta=a}set learningRate(t){this._learningrate=t}manager(){const t=this;return{get lr(){return t._learningrate},params:{},delta(a,s){const o=typeof s=="number";if(o&&(s=new c(1,1,s)),!this.params[a]){const r=s.copy();r.fill(0),this.params[a]={m:r.copy(),v:r}}this.params[a].m.broadcastOperate(s,(r,e)=>r*t._beta+e*(1-t._beta)),this.params[a].v.broadcastOperate(s,(r,e)=>r*t._beta+e**2*(1-t._beta));const i=this.params[a].m.copy();return i.broadcastOperate(this.params[a].v,(r,e)=>e-r**2),i.broadcastOperate(s,(r,e)=>e*this.lr/Math.sqrt(r+1e-12)),o?i.toScaler():i}}}}
