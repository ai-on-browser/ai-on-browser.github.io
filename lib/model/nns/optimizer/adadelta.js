var c=Object.defineProperty;var o=(n,a)=>c(n,"name",{value:a,configurable:!0});import h from"../../../util/matrix.js";export class AdaDeltaOptimizer{static{o(this,"AdaDeltaOptimizer")}constructor(a,r=.95){this._learningrate=a,this._beta=r}set learningRate(a){this._learningrate=a}manager(){const a=this;return{get lr(){return a._learningrate},params:{},delta(r,e){const p=typeof e=="number";if(p&&(e=new h(1,1,e)),!this.params[r]){const t=e.copy();t.fill(0),this.params[r]={v:t.copy(),u:t}}this.params[r].v.broadcastOperate(e,(t,s)=>t*a._beta+(1-a._beta)*s**2);const i=this.params[r].v.copy();return i.broadcastOperate(this.params[r].u,(t,s)=>Math.sqrt(s+1e-12)/Math.sqrt(t+1e-12)),i.broadcastOperate(e,(t,s)=>t*s),this.params[r].u.broadcastOperate(i,(t,s)=>t*a._beta+(1-a._beta)*s**2),i.map(t=>this.lr*t),p?i.toScaler():i}}}}
