var h=Object.defineProperty;var c=(n,t)=>h(n,"name",{value:t,configurable:!0});import m from"../../../util/matrix.js";export class AdaMaxOptimizer{static{c(this,"AdaMaxOptimizer")}constructor(t=.002,a=.9,s=.999){this._learningrate=t,this._beta1=a,this._beta2=s}set learningRate(t){this._learningrate=t}manager(){const t=this;return{get lr(){return t._learningrate},params:{},delta(a,s){const p=typeof s=="number";if(p&&(s=new m(1,1,s)),!this.params[a]){const r=s.copy();r.fill(0),this.params[a]={v:r.copy(),s:r,c:1}}this.params[a].v.broadcastOperate(s,(r,i)=>r*t._beta1+i*(1-t._beta1)),this.params[a].s.broadcastOperate(s,(r,i)=>Math.max(r*t._beta2,Math.abs(i)));const o=1-t._beta1**this.params[a].c,e=this.params[a].v.copy();return e.broadcastOperate(this.params[a].s,(r,i)=>r/o*(this.lr/i)),this.params[a].c++,p?e.toScaler():e}}}}
