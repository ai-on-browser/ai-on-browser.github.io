var _=Object.defineProperty;var c=(o,t)=>_(o,"name",{value:t,configurable:!0});import u from"../../../util/matrix.js";export class NadamOptimizer{static{c(this,"NadamOptimizer")}constructor(t=.002,a=.975,s=.999){this._learningrate=t,this._mu=a,this._nu=s}set learningRate(t){this._learningrate=t}manager(){const t=this;return{get lr(){return t._learningrate},params:{},delta(a,s){const p=typeof s=="number";if(p&&(s=new u(1,1,s)),!this.params[a]){const r=s.copy();r.fill(0),this.params[a]={m:r.copy(),v:r,t:1}}this.params[a].m.broadcastOperate(s,(r,n)=>r*t._mu+n*(1-t._mu)),this.params[a].v.broadcastOperate(s,(r,n)=>r*t._nu+n**2*(1-t._nu));const m=this.params[a].t,e=this.params[a].m.copy();e.broadcastOperate(s,(r,n)=>r*t._mu/(1-t._mu**(m+1))+n*(1-t._mu)/(1-t._mu**m));const h=t._nu/(1-t._nu**m),i=this.params[a].v.copy();return i.broadcastOperate(e,(r,n)=>this.lr*n/Math.sqrt(h*r+1e-12)),this.params[a].t++,p?i.toScaler():i}}}}
