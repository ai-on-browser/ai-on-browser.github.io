var b=Object.defineProperty;var m=(n,t)=>b(n,"name",{value:t,configurable:!0});import _ from"../../../util/matrix.js";export class AdaBeliefOptimizer{static{m(this,"AdaBeliefOptimizer")}constructor(t=.001,a=.9,s=.999){this._learningrate=t,this._beta1=a,this._beta2=s}set learningRate(t){this._learningrate=t}manager(){const t=this;return{get lr(){return t._learningrate},params:{},delta(a,s){const o=typeof s=="number";if(o&&(s=new _(1,1,s)),!this.params[a]){const r=s.copy();r.fill(0),this.params[a]={m:r.copy(),v:r,t:1}}this.params[a].m.broadcastOperate(s,(r,e)=>r*t._beta1+e*(1-t._beta1));const p=this.params[a].m.copy();p.broadcastOperate(s,(r,e)=>e-r),this.params[a].v.broadcastOperate(p,(r,e)=>r*t._beta2+(1-t._beta2)*e*e);const c=1-t._beta1**this.params[a].t,h=1-t._beta2**this.params[a].t,i=this.params[a].m.copy();return i.broadcastOperate(this.params[a].v,(r,e)=>r/c*(this.lr/Math.sqrt(e/h+1e-12))),this.params[a].t++,o?i.toScaler():i}}}}
