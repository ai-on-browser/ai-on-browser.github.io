import Layer from"./base.js";export default class HexpoLayer extends Layer{constructor({a:t=1,b:s=1,c:e=1,d:h=1,...i}){super(i),this._a=t,this._b=s,this._c=e,this._d=h}calc(t){this._i=t;const s=this._i.copy();return s.map((t=>t>=0?-this._a*(Math.exp(-t/this._b)-1):this._c*(Math.exp(t/this._d)-1))),s}grad(t){const s=t.copy();return s.broadcastOperate(this._i,((t,s)=>t*(s>=0?this._a/this._b*Math.exp(-s/this._b):this._c/this._d*Math.exp(s/this._d)))),s}toObject(){return{type:"hexpo",a:this._a,b:this._b,c:this._c,d:this._d}}}HexpoLayer.registLayer("hexpo");