var c=Object.defineProperty;var _=(e,t)=>c(e,"name",{value:t,configurable:!0});import o from"./base.js";export default class a extends o{static{_(this,"HexpoLayer")}constructor({a:t=1,b:s=1,c:h=1,d:i=1,...r}){super(r),this._a=t,this._b=s,this._c=h,this._d=i}calc(t){this._i=t;const s=this._i.copy();return s.map(h=>h>=0?-this._a*(Math.exp(-h/this._b)-1):this._c*(Math.exp(h/this._d)-1)),s}grad(t){const s=t.copy();return s.broadcastOperate(this._i,(h,i)=>h*(i>=0?this._a/this._b*Math.exp(-i/this._b):this._c/this._d*Math.exp(i/this._d))),s}toObject(){return{type:"hexpo",a:this._a,b:this._b,c:this._c,d:this._d}}}a.registLayer("hexpo");
