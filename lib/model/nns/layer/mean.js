import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class MeanLayer extends Layer{constructor({axis:t=-1,...i}){super(i),this._axis=t}calc(t){if(this._i=t,this._axis<0)return new Matrix(1,1,t.reduce(((t,i)=>t+i),0)/t.length);const i=t.reduce(((t,i)=>t+i),0,this._axis,!0);return i.map((i=>i/t.sizes[this._axis])),i}grad(t){if(this._axis<0){const i=this._i.copy();return i.fill(t.toScaler()/this._i.length),i}const i=this._i.copy();return i.broadcastOperate(t,((t,i)=>i/this._i.sizes[this._axis])),i}toObject(){return{type:"mean",axis:this._axis}}}MeanLayer.registLayer();