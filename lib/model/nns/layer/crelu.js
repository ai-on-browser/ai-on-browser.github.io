import Layer from"./base.js";export default class ConcatenatedReLULayer extends Layer{calc(e){this._i=e;const s=e.copy();s.map((e=>e>0?e:0));const t=e.copy();return t.map((e=>e<0?-e:0)),s.concat(t,s.dimension-1),s}grad(e){const s=this._i.dimension-1,t=e.slice(0,this._i.sizes[s],s),i=e.slice(this._i.sizes[s],e.sizes[s],s);return t.map(((e,s)=>this._i.at(s)>=0?e:-i.at(s))),t}}ConcatenatedReLULayer.registLayer("crelu");