var o=Object.defineProperty;var h=(i,t)=>o(i,"name",{value:t,configurable:!0});import p from"./base.js";export default class r extends p{static{h(this,"ESwishLayer")}constructor({beta:t=1,...e}){super(e),this._beta=t}calc(t){this._i=t;const e=t.copy();return e.map(a=>this._beta*a/(1+Math.exp(-a))),e}grad(t){this._bo=t;const e=t.copy();return e.broadcastOperate(this._i,(a,s)=>a*this._beta*(1+s*Math.exp(-s)/(1+Math.exp(-s)))/(1+Math.exp(-s))),e}update(t){let e=0;for(let a=0;a<this._i.length;a++)e+=this._bo.value[a]*(this._i.value[a]/(1+Math.exp(-this._i.value[a])));this._beta-=t.delta("beta",e/this._i.length)}toObject(){return{type:"eswish",beta:this._beta}}}r.registLayer("eswish");
