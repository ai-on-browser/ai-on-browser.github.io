import Layer from"./base.js";export default class ElasticELULayer extends Layer{constructor({k:t=1,alpha:a=1,beta:e=1,...h}){super(h),this._k=t,this._alpha=a,this._beta=e}calc(t){this._i=t;const a=t.copy();return a.map((t=>t>0?this._k*t:this._alpha*(Math.exp(this._beta*t)-1))),a}grad(t){this._bo=t;const a=t.copy();return a.broadcastOperate(this._i,((t,a)=>t*(a>0?this._k:this._alpha*this._beta*Math.exp(this._beta*a)))),a}update(t){let a=0,e=0;for(let t=0;t<this._i.length;t++)this._i.value[t]>0||(a+=this._bo.value[t]*(Math.exp(this._beta*this._i.value[t])-1),e+=this._bo.value[t]*(this._alpha*this._i.value[t]*Math.exp(this._beta*this._i.value[t])));this._alpha-=t.delta("alpha",a/this._i.length),this._beta-=t.delta("beta",e/this._i.length)}toObject(){return{type:"eelu",k:this._k,alpha:this._alpha,beta:this._beta}}}ElasticELULayer.registLayer("eelu");