var l=Object.defineProperty;var s=(i,a)=>l(i,"name",{value:a,configurable:!0});import p from"./base.js";export default class _ extends p{static{s(this,"ElasticELULayer")}constructor({k:a=1,alpha:e=1,beta:h=1,...t}){super(t),this._k=a,this._alpha=e,this._beta=h}calc(a){this._i=a;const e=a.copy();return e.map(h=>h>0?this._k*h:this._alpha*(Math.exp(this._beta*h)-1)),e}grad(a){this._bo=a;const e=a.copy();return e.broadcastOperate(this._i,(h,t)=>h*(t>0?this._k:this._alpha*this._beta*Math.exp(this._beta*t))),e}update(a){let e=0,h=0;for(let t=0;t<this._i.length;t++)this._i.value[t]>0||(e+=this._bo.value[t]*(Math.exp(this._beta*this._i.value[t])-1),h+=this._bo.value[t]*(this._alpha*this._i.value[t]*Math.exp(this._beta*this._i.value[t])));this._alpha-=a.delta("alpha",e/this._i.length),this._beta-=a.delta("beta",h/this._i.length)}toObject(){return{type:"eelu",k:this._k,alpha:this._alpha,beta:this._beta}}}_.registLayer("eelu");
