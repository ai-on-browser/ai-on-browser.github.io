var r=Object.defineProperty;var l=(i,t)=>r(i,"name",{value:t,configurable:!0});import p from"./base.js";export default class _ extends p{static{l(this,"ParametricTanhLinearUnitLayer")}constructor({alpha:t=1,beta:a=1,...h}){super(h),this._alpha=t,this._beta=a}calc(t){this._i=t;const a=t.copy();return a.map(h=>h>0?h:this._alpha*Math.tanh(this._beta*h)),a}grad(t){this._bo=t;const a=t.copy();return a.broadcastOperate(this._i,(h,e)=>h*(e>0?1:this._alpha*this._beta*(1-Math.tanh(this._beta*e)**2))),a}update(t){let a=0,h=0;for(let e=0;e<this._i.length;e++){if(this._i.value[e]>0)continue;const s=Math.tanh(this._beta*this._i.value[e]);a+=this._bo.value[e]*s,h+=this._bo.value[e]*this._alpha*(1-s**2)}this._alpha-=t.delta("alpha",a/this._i.length),this._alpha<0&&(this._alpha=0),this._beta-=t.delta("beta",h/this._i.length),this._beta<0&&(this._beta=0)}toObject(){return{type:"ptelu",alpha:this._alpha,beta:this._beta}}}_.registLayer("ptelu");
