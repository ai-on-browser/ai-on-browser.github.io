import Matrix from"../../../util/matrix.js";import{NeuralnetworkException}from"../../neuralnetwork.js";const layerClasses={};export default class Layer{constructor({}){}static fromObject(e){const t=layerClasses[e.type];if(!t)throw new NeuralnetworkException(`Invalid layer type: ${e.type}`);return new t(e)}static registLayer(e,t){if(t||=this,e||t===Layer||(e=this.name.replace(/Layer$/,"").replace(/[A-Z]/g,(e=>"_"+e.toLowerCase())).slice(1),t=this),layerClasses[e])throw new NeuralnetworkException(`Layer name '${e}' already exists.`);layerClasses[e]=t}bind(e){}calc(...e){throw new NeuralnetworkException("Not impleneted",this)}grad(...e){throw new NeuralnetworkException("Not impleneted",this)}update(e){}toObject(){for(const e of Object.keys(layerClasses))if(this.constructor===layerClasses[e])return{type:e};return{}}}export class LossLayer extends Layer{calc(e){return e}grad(){return new Matrix(1,1,1)}}layerClasses.loss=LossLayer;export class FlowLayer extends Layer{inverse(...e){throw new NeuralnetworkException("Not impleneted",this)}jacobianDeterminant(){throw new NeuralnetworkException("Not impleneted",this)}}