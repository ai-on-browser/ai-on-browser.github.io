var l=Object.defineProperty;var a=(e,i)=>l(e,"name",{value:i,configurable:!0});import b from"./base.js";export default class _ extends b{static{a(this,"ParametricELULayer")}constructor({a:i=1,b:s=1,...h}){super(h),this._a=i,this._b=s}calc(i){this._i=i;const s=i.copy();return s.map(h=>this._a*(h>=0?h/this._b:Math.exp(h/this._b)-1)),s}grad(i){this._bo=i;const s=i.copy();return s.broadcastOperate(this._i,(h,t)=>h*this._a/this._b*(t>=0?1:Math.exp(t/this._b))),s}update(i){let s=0,h=0;for(let t=0;t<this._i.length;t++)this._i.value[t]>=0?(s+=this._bo.value[t]*(this._i.value[t]/this._b),h+=this._bo.value[t]*(-this._a*this._i.value[t]/this._b**2)):(s+=this._bo.value[t]*(Math.exp(this._i.value[t]/this._b)-1),h+=this._bo.value[t]*(this._a*Math.exp(this._i.value[t]/this._b)*(-this._i.value[t]/this._b**2)));this._a-=i.delta("a",s/this._i.length),this._a<.1&&(this._a=.1),this._b-=i.delta("b",h/this._i.length),this._b<.1&&(this._b=.1)}toObject(){return{type:"pelu",a:this._a,b:this._b}}}_.registLayer("pelu");
