var i=Object.defineProperty;var s=(r,t)=>i(r,"name",{value:t,configurable:!0});import n from"./base.js";export default class o extends n{static{s(this,"PenalizedTanhLayer")}constructor({a:t=.25,...a}){super(a),this._a=t}calc(t){return this._o=t.copy(),this._o.map(a=>Math.tanh(a)*(a<0?this._a:1)),this._o}grad(t){const a=t.copy();return a.broadcastOperate(this._o,(h,e)=>h*(1-e**2)*(e<0?this._a:1)),a}toObject(){return{type:"ptanh",a:this._a}}}o.registLayer("ptanh");
