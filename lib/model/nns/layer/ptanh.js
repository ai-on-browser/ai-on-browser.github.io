import Layer from"./base.js";export default class PenalizedTanhLayer extends Layer{constructor({a:a=.25,...t}){super(t),this._a=a}calc(a){return this._o=a.copy(),this._o.map((a=>Math.tanh(a)*(a<0?this._a:1))),this._o}grad(a){const t=a.copy();return t.broadcastOperate(this._o,((a,t)=>a*(1-t**2)*(t<0?this._a:1))),t}toObject(){return{type:"ptanh",a:this._a}}}PenalizedTanhLayer.registLayer("ptanh");