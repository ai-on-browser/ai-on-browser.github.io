import Layer from"./base.js";export default class BoundedReLULayer extends Layer{constructor({a:e=1,...t}){super(t),this._a=e}calc(e){this._i=e;const t=e.copy();return t.map((e=>e<=0?0:e>=this._a?this._a:e)),t}grad(e){this._bo=e;const t=e.copy();return t.broadcastOperate(this._i,((e,t)=>0<t&&t<this._a?e:0)),t}toObject(){return{type:"brelu",a:this._a}}}BoundedReLULayer.registLayer("brelu");