import Tensor from"../../../util/tensor.js";import Layer from"./base.js";export{default as Layer,LossLayer,FlowLayer}from"./base.js";const buildLayer=(r,o,a)=>{class s extends Layer{calc(r){return this._i=r,this._o=r.copy(),this._o.map(o),this._o}grad(r){const o=new Tensor(r.sizes);for(let s=0;s<o.length;s++)o.value[s]=r.value[s]*a(this._i.value[s],this._o.value[s]);return 2===o.dimension?o.toMatrix():o}}Object.defineProperty(s,"name",{value:r[0].toUpperCase()+r.substring(1).toLowerCase()+"Layer"}),s.registLayer(r)},simpleLayers={abs:{calc:Math.abs,grad:(r,o)=>r<0?-1:1},acos:{calc:Math.acos,grad:(r,o)=>-1/(Math.sqrt(1-r**2)+1e-4)},acosh:{calc:Math.acosh,grad:(r,o)=>1/(Math.sqrt(r**2-1)+1e-4)},asin:{calc:Math.asin,grad:(r,o)=>1/(Math.sqrt(1-r**2)+1e-4)},asinh:{calc:Math.asinh,grad:(r,o)=>1/Math.sqrt(1+r**2)},atan:{calc:Math.atan,grad:(r,o)=>1/(1+r**2)},atanh:{calc:Math.atanh,grad:(r,o)=>1/(1-r**2)},cos:{calc:Math.cos,grad:(r,o)=>-Math.sin(r)},cosh:{calc:Math.cosh,grad:(r,o)=>Math.sinh(r)},exp:{calc:Math.exp,grad:(r,o)=>o},log:{calc:Math.log,grad:(r,o)=>1/r},negative:{calc:r=>-r,grad:(r,o)=>-1},relu:{calc:r=>r>0?r:0,grad:(r,o)=>r>0?1:0},sin:{calc:Math.sin,grad:(r,o)=>Math.cos(r)},sinh:{calc:Math.sinh,grad:(r,o)=>Math.cosh(r)},softsign:{calc:r=>r/(1+Math.abs(r)),grad:(r,o)=>1/(1+Math.abs(r))**2},sqrt:{calc:Math.sqrt,grad:(r,o)=>1/(2*o)},square:{calc:r=>r**2,grad:(r,o)=>2*r},tan:{calc:Math.tan,grad:(r,o)=>1/Math.cos(r)**2},tanh:{calc:Math.tanh,grad:(r,o)=>1-o**2}};for(const r of Object.keys(simpleLayers))buildLayer(r,simpleLayers[r].calc,simpleLayers[r].grad);export*from"./add.js";export*from"./additive_coupling.js";export*from"./argmax.js";export*from"./averagepool.js";export*from"./batch_normalization.js";export*from"./clip.js";export*from"./concat.js";export*from"./cond.js";export*from"./const.js";export*from"./conv.js";export*from"./detach.js";export*from"./div.js";export*from"./dropout.js";export*from"./elu.js";export*from"./flatten.js";export*from"./full.js";export*from"./gaussian.js";export*from"./gru.js";export*from"./huber.js";export*from"./include.js";export*from"./input.js";export*from"./leaky_relu.js";export*from"./less.js";export*from"./linear.js";export*from"./lppool.js";export*from"./lrn.js";export*from"./lstm.js";export*from"./matmul.js";export*from"./maxpool.js";export*from"./mean.js";export*from"./mse.js";export*from"./mult.js";export*from"./onehot.js";export*from"./output.js";export*from"./power.js";export*from"./prelu.js";export*from"./random.js";export*from"./reshape.js";export*from"./reverse.js";export*from"./rnn.js";export*from"./rrelu.js";export*from"./sigmoid.js";export*from"./softargmax.js";export*from"./softmax.js";export*from"./softplus.js";export*from"./sparse.js";export*from"./split.js";export*from"./std.js";export*from"./sub.js";export*from"./sum.js";export*from"./supervisor.js";export*from"./transpose.js";export*from"./variable.js";export*from"./variance.js";