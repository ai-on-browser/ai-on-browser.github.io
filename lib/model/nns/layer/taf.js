var r=Object.defineProperty;var e=(h,t)=>r(h,"name",{value:t,configurable:!0});import l from"./base.js";export default class _ extends l{static{e(this,"TrainableAFLayer")}constructor({a:t=0,b:s=0,...i}){super(i),this._a=t,this._b=s}calc(t){this._i=t;const s=t.copy();return s.map(i=>Math.sqrt((i-this._a)**2+this._b**2)),s}grad(t){this._bo=t;const s=t.copy();return s.broadcastOperate(this._i,(i,a)=>i*(a-this._a)/Math.sqrt((a-this._a)**2+this._b**2)),s}update(t){let s=0,i=0;for(let a=0;a<this._i.length;a++)s+=this._bo.value[a]*((this._a-this._i.value[a])/Math.sqrt((this._i.value[a]-this._a)**2+this._b**2)),i+=this._bo.value[a]*(this._b/Math.sqrt((this._i.value[a]-this._a)**2+this._b**2));this._a-=t.delta("a",s/this._i.length),this._b-=t.delta("b",i/this._i.length)}toObject(){return{type:"taf",a:this._a,b:this._b}}}_.registLayer("taf");
