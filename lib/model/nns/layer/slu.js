var p=Object.defineProperty;var l=(i,t)=>p(i,"name",{value:t,configurable:!0});import r from"./base.js";export default class _ extends r{static{l(this,"SoftplusLinearUnitLayer")}constructor({alpha:t=1,beta:a=1,gamma:e=0,...h}){super(h),this._alpha=t,this._beta=a,this._gamma=e}calc(t){this._i=t;const a=t.copy();return a.map(e=>e>=0?this._alpha*e:this._beta*Math.log(Math.exp(e)+1)-this._gamma),a}grad(t){this._bo=t;const a=t.copy();return a.broadcastOperate(this._i,(e,h)=>e*(h>=0?this._alpha:this._beta*Math.exp(h)/(Math.exp(h)+1))),a}update(t){let a=0,e=0,h=0;for(let s=0;s<this._i.length;s++)this._i.value[s]>=0?a+=this._bo.value[s]*this._i.value[s]:(e+=this._bo.value[s]*Math.log(Math.exp(this._i.value[s])+1),h+=this._bo.value[s]);this._alpha-=t.delta("alpha",a/this._i.length),this._beta-=t.delta("beta",e/this._i.length),this._gamma-=t.delta("gamma",h/this._i.length)}toObject(){return{type:"slu",alpha:this._alpha,beta:this._beta,gamma:this._gamma}}}_.registLayer("slu");
