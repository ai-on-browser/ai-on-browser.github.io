import Layer from"./base.js";export default class SoftRootSignLayer extends Layer{constructor({alpha:t=3,beta:a=2,...e}){super(e),this._alpha=t,this._beta=a}calc(t){this._i=t;const a=t.copy();return a.map((t=>t/(t/this._alpha+Math.exp(-t/this._beta)))),a}grad(t){const a=t.copy();return a.broadcastOperate(this._i,((t,a)=>t*((1+a/this._beta)*Math.exp(-a/this._beta)/(a/this._alpha+Math.exp(-a/this._beta))**2))),a}toObject(){return{type:"srs",alpha:this._alpha,beta:this._beta}}}SoftRootSignLayer.registLayer("srs");