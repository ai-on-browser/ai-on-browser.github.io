import Layer from"./base.js";export default class ParametricReLULayer extends Layer{constructor({a:t=.25,...a}){super(a),this._a=t,this._da=0}calc(t){return this._i=t,this._o=t.copy(),this._o.map((t=>t>0?t:this._a*t)),this._o}grad(t){this._bo=t;const a=t.copy();return a.broadcastOperate(this._i,((t,a)=>t*(a>0?1:this._a))),a}update(t){let a=0;for(let t=0;t<this._i.length;t++)this._i.value[t]<0&&(a+=this._bo.value[t]*this._i.value[t]);this._da=.1*this._da+t.lr*a/this._i.length,this._a-=this._da}toObject(){return{type:"prelu",a:this._a}}}ParametricReLULayer.registLayer("prelu");