import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class SparseLayer extends Layer{constructor({rho:t,beta:r,...a}){super(a),this._rho=t,this._beta=r}bind({rho:t}){this._rho=t||this._rho}calc(t){return this._rho_hat=t.mean(0),t}grad(t){const r=Matrix.div(-this._rho,this._rho_hat);return r.add(Matrix.div(1-this._rho,Matrix.sub(1,this._rho_hat))),r.mult(this._beta),Matrix.add(t,r)}toObject(){return{type:"sparsity",rho:this._rho,beta:this._beta}}}SparseLayer.registLayer("sparsity");