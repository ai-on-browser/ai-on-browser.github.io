var a=Object.defineProperty;var l=(r,t)=>a(r,"name",{value:t,configurable:!0});import h,{NeuralnetworkLayerException as n}from"./base.js";import c from"../../../util/matrix.js";export default class o extends h{static{l(this,"OnehotLayer")}constructor({class_size:t=null,values:s=[],...i}){super(i),this._c=t,this._values=s}calc(t){if(t.cols!==1)throw new n("Invalid input.",[this,t]);const s=[...new Set(t.value)];this._c||(this._c=s.length),this._i=t;for(let e=0;e<s.length&&this._values.length<this._c;e++)this._values.includes(s[e])||this._values.push(s[e]);const i=c.zeros(t.rows,this._c);for(let e=0;e<t.rows;e++)i.set(e,this._values.indexOf(t.at(e,0)),1);return i}grad(){const t=this._i.copy();return t.fill(0),t}toObject(){return{type:"onehot",class_size:this._c,values:this._values}}}o.registLayer();
