import Layer,{NeuralnetworkLayerException}from"./base.js";import Matrix from"../../../util/matrix.js";export default class OnehotLayer extends Layer{constructor({class_size:e=null,values:t=[],...s}){super(s),this._c=e,this._values=t}calc(e){if(1!==e.cols)throw new NeuralnetworkLayerException("Invalid input.",[this,e]);const t=[...new Set(e.value)];this._c||(this._c=t.length);for(let e=0;e<t.length&&this._values.length<this._c;e++)this._values.indexOf(t[e])<0&&this._values.push(t[e]);const s=Matrix.zeros(e.rows,this._c);for(let t=0;t<e.rows;t++)s.set(t,this._values.indexOf(e.at(t,0)),1);return s}grad(){}toObject(){return{type:"onehot",class_size:this._c,values:this._values}}}OnehotLayer.registLayer();