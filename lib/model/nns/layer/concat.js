import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class ConcatLayer extends Layer{constructor({axis:s=1,...t}){super(t),this._axis=s}calc(...s){let t=s[0],i=s[0].sizes[this._axis];this._sizes=[0,i];for(let e=1;e<s.length;e++)t=Matrix.concat(t,s[e],this._axis),this._sizes.push(i+=s[e].sizes[this._axis]);return t}grad(s){const t=[];for(let i=0;i<this._sizes.length-1;i++)t.push(s.slice(this._sizes[i],this._sizes[i+1],this._axis));return t}toObject(){return{type:"concat",axis:this._axis}}}ConcatLayer.registLayer();