import Layer from"./base.js";export default class ImprovedSigmoidLayer extends Layer{constructor({a:a=1,alpha:t=1,...i}){super(i),this._a=a,this._alpha=t}calc(a){const t=1/(1+Math.exp(-this._a)),i=1/(1+Math.exp(this._a));return this._i=a,this._o=a.copy(),this._o.map((a=>-this._a<a&&a<this._a?1/(1+Math.exp(-a)):a>=this._a?t+this._alpha*(a-this._a):i+this._alpha*(a+this._a))),this._o}grad(a){const t=1/(1+Math.exp(-this._a)),i=1/(1+Math.exp(this._a)),s=a.copy();return s.broadcastOperate(this._o,((a,s)=>a*(i<s&&s<t?s*(1-s):this._alpha))),s}toObject(){return{type:"isigmoid",a:this._a,alpha:this._alpha}}}ImprovedSigmoidLayer.registLayer("isigmoid");