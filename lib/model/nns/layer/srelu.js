import Layer from"./base.js";export default class ShiftedReLULayer extends Layer{constructor({d:t=0,...e}){super(e),this._d=t}calc(t){this._i=t;const e=t.copy();return e.map((t=>t>this._d?t:this._d)),e}grad(t){this._bo=t;const e=t.copy();return e.broadcastOperate(this._i,((t,e)=>e>this._d?t:0)),e}update(t){let e=0;for(let t=0;t<this._i.length;t++)this._i.value[t]>0||(e+=this._bo.value[t]);this._d-=t.delta("delta",e)}toObject(){return{type:"srelu",d:this._d}}}ShiftedReLULayer.registLayer("srelu");