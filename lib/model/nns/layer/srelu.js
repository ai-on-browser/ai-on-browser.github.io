var o=Object.defineProperty;var r=(i,t)=>o(i,"name",{value:t,configurable:!0});import h from"./base.js";export default class a extends h{static{r(this,"ShiftedReLULayer")}constructor({d:t=0,...e}){super(e),this._d=t}calc(t){this._i=t;const e=t.copy();return e.map(s=>s>this._d?s:this._d),e}grad(t){this._bo=t;const e=t.copy();return e.broadcastOperate(this._i,(s,d)=>d>this._d?s:0),e}update(t){let e=0;for(let s=0;s<this._i.length;s++)this._i.value[s]>0||(e+=this._bo.value[s]);this._d-=t.delta("delta",e)}toObject(){return{type:"srelu",d:this._d}}}a.registLayer("srelu");
