var o=Object.defineProperty;var r=(i,t)=>o(i,"name",{value:t,configurable:!0});import _ from"./base.js";export default class h extends _{static{r(this,"BendableLinearUnitLayer")}constructor({beta:t=.1,...e}){super(e),this._beta=t}calc(t){this._i=t;const e=t.copy();return e.map(a=>this._beta*(Math.sqrt(a**2+1)-1)+a),e}grad(t){this._bo=t;const e=t.copy();return e.broadcastOperate(this._i,(a,s)=>a*(this._beta*s/Math.sqrt(s**2+1)+1)),e}update(t){const e=this._bo.reduce((a,s,b)=>a+s*(Math.sqrt(this._i.at(b)**2+1)-1),0)/this._bo.length;this._beta-=t.delta("beta",e),this._beta<-1?this._beta=-1:this._beta>1&&(this._beta=1)}toObject(){return{type:"blu",beta:this._beta}}}h.registLayer("blu");
