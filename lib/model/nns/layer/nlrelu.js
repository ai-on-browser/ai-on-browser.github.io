import Layer from"./base.js";export default class NaturalLogarithmReLULayer extends Layer{constructor({beta:t=1,...e}){super(e),this._beta=t}calc(t){this._i=t;const e=t.copy();return e.map((t=>Math.log(this._beta*(t>0?t:0)+1))),e}grad(t){const e=t.copy();return e.broadcastOperate(this._i,((t,e)=>e>=0?t*(this._beta/(this._beta*e+1)):0)),e}toObject(){return{type:"nlrelu",beta:this._beta}}}NaturalLogarithmReLULayer.registLayer("nlrelu");