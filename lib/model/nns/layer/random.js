import Layer from"./base.js";import Matrix from"../../../util/matrix.js";import Tensor from"../../../util/tensor.js";export default class RandomLayer extends Layer{constructor({size:s,mean:i=0,variance:r=1,...t}){super(t),this._size=s,this._mean=i,this._variance=r,this._rows=1}bind({n:s}){this._rows=s}calc(){if("string"==typeof this._size){const s=this.graph.getNode(this._size).lastOutputSize;return 2===s.length?Matrix.randn(s[0],s[1],this._mean,this._variance):Tensor.randn(s,this._mean,this._variance)}return Array.isArray(this._size)?Tensor.randn([this._rows,...this._size],this._mean,this._variance):Matrix.randn(this._rows,this._size,this._mean,this._variance)}grad(){}toObject(){return{type:"random",size:this._size}}}RandomLayer.registLayer();