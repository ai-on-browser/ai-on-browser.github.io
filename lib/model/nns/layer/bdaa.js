import Layer from"./base.js";export default class BimodalDerivativeAdaptiveActivationLayer extends Layer{constructor({alpha:a=1,...t}){super(t),this._alpha=a}calc(a){this._i=a;const t=a.copy();return t.map((a=>(1/(1+Math.exp(-a))-1/(1+Math.exp(-a-this._alpha)))/2)),t}grad(a){this._bo=a;const t=a.copy();return t.broadcastOperate(this._i,((a,t)=>a*(Math.exp(-t)/(1+Math.exp(-t))**2-Math.exp(-t-this._alpha)/(1+Math.exp(-t-this._alpha))**2)/2)),t}update(a){let t=0;for(let a=0;a<this._i.length;a++)t+=this._bo.value[a]*(-Math.exp(-this._i.value[a]-this._alpha)/(1+Math.exp(-this._i.value[a]-this._alpha))**2)/2;this._alpha-=a.delta("alpha",t/this._i.length)}toObject(){return{type:"bdaa",alpha:this._alpha}}}BimodalDerivativeAdaptiveActivationLayer.registLayer("bdaa");