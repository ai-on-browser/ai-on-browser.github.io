var l=Object.defineProperty;var p=(i,a)=>l(i,"name",{value:a,configurable:!0});import r from"./base.js";export default class s extends r{static{p(this,"BimodalDerivativeAdaptiveActivationLayer")}constructor({alpha:a=1,...t}){super(t),this._alpha=a}calc(a){this._i=a;const t=a.copy();return t.map(e=>(1/(1+Math.exp(-e))-1/(1+Math.exp(-e-this._alpha)))/2),t}grad(a){this._bo=a;const t=a.copy();return t.broadcastOperate(this._i,(e,h)=>e*(Math.exp(-h)/(1+Math.exp(-h))**2-Math.exp(-h-this._alpha)/(1+Math.exp(-h-this._alpha))**2)/2),t}update(a){let t=0;for(let e=0;e<this._i.length;e++)t+=this._bo.value[e]*(-Math.exp(-this._i.value[e]-this._alpha)/(1+Math.exp(-this._i.value[e]-this._alpha))**2)/2;this._alpha-=a.delta("alpha",t/this._i.length)}toObject(){return{type:"bdaa",alpha:this._alpha}}}s.registLayer("bdaa");
