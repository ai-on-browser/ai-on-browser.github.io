import Layer from"./base.js";export default class FlexibleReLULayer extends Layer{constructor({b:e=0,...t}){super(t),this._b=e}calc(e){this._i=e;const t=e.copy();return t.map((e=>(e>0?e:0)+this._b)),t}grad(e){this._bo=e;const t=e.copy();return t.broadcastOperate(this._i,((e,t)=>t>0?e:0)),t}update(e){const t=this._bo.reduce(((e,t)=>e+t),0)/this._bo.length;this._b-=e.delta("bias",t)}toObject(){return{type:"frelu",b:this._b}}}FlexibleReLULayer.registLayer("frelu");