var f=Object.defineProperty;var s=(a,t)=>f(a,"name",{value:t,configurable:!0});import h from"./base.js";import n from"../../../util/matrix.js";import o from"../../../util/tensor.js";export default class c extends h{static{s(this,"MSELayer")}bind({supervisor:t}){Array.isArray(t)?(this._t=o.fromArray(t),this._t.dimension===2&&(this._t=this._t.toMatrix())):(t instanceof n||t instanceof o)&&(this._t=t)}calc(t){this._i=t;const r=t.copy();return r.broadcastOperate(this._t,(i,e)=>(i-e)**2),new n(1,1,r.reduce((i,e)=>i+e,0)/r.length)}grad(t){t=t.toScaler();const r=this._i.copy();return r.broadcastOperate(this._t,(i,e)=>t*(i-e)/2),r}}c.registLayer("mse");
