import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class AddLayer extends Layer{calc(...r){this._sizes=r.map((r=>r.sizes));let e=r[0].copy();for(let t=1;t<r.length;t++)e.add(r[t]);return e}grad(r){const e=r.sizes;return this._sizes.map((t=>{if(e.map(((r,e)=>r/t[e])).every((r=>1===r)))return r;const s=Matrix.zeros(t[0],t[1]);for(let a=0;a<e[0];a++)for(let i=0;i<e[1];i++)s.addAt(a%t[0],i%t[1],r.at(a,i));return s}))}}AddLayer.registLayer();