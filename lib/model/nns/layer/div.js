import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class DivLayer extends Layer{calc(...t){this._i=t,this._den=t[1].copy();for(let e=2;e<t.length;e++)this._den.mult(t[e]);return t[0].copyDiv(this._den)}grad(t){const e=this._i[0].copyMult(-1);return e.div(this._den),e.div(this._den),e.mult(t),this._i.map(((i,s)=>{const r=i.sizes;let o;if(0===s)o=t.copyDiv(this._den);else{o=e.copy();for(let t=1;t<this._i.length;t++)s!==t&&o.mult(this._i[t])}if(o.sizes.map(((t,e)=>t/r[e])).every((t=>1===t)))return o;const a=Matrix.zeros(r[0],r[1]);for(let t=0;t<o.sizes[0];t++)for(let e=0;e<o.sizes[1];e++)a.addAt(t%r[0],e%r[1],o.at(t,e));return a}))}}DivLayer.registLayer();