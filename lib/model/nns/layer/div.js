import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class DivLayer extends Layer{calc(...t){this._i=t,this._den=t[1].copy();for(let i=2;i<t.length;i++)this._den.mult(t[i]);return Matrix.div(t[0],this._den)}grad(t){const i=Matrix.mult(this._i[0],-1);return i.div(this._den),i.div(this._den),i.mult(t),this._i.map(((e,r)=>{const s=e.sizes;let a;if(0===r)a=Matrix.div(t,this._den);else{a=i.copy();for(let t=1;t<this._i.length;t++)r!==t&&a.mult(this._i[t])}if(a.sizes.map(((t,i)=>t/s[i])).every((t=>1===t)))return a;const l=Matrix.zeros(s[0],s[1]);for(let t=0;t<a.sizes[0];t++)for(let i=0;i<a.sizes[1];i++)l.addAt(t%s[0],i%s[1],a.at(t,i));return l}))}}DivLayer.registLayer();