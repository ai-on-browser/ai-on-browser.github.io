import Layer from"./base.js";import Matrix from"../../../util/matrix.js";export default class SplitLayer extends Layer{constructor({axis:s=1,size:t,...i}){super(i),this._axis=s,this._size=t}calc(s){let t=0;if(this._o=[],"number"==typeof this._size){const i=s.sizes[this._axis]/this._size;for(let e=0;e<this._size;e++){const r=Math.round((e+1)*i);this._o.push(s.slice(t,r,this._axis)),t=r}}else for(let i=0;i<this._size.length;i++)this._o.push(s.slice(t,t+this._size[i],this._axis)),t+=this._size[i];return this._o}grad(...s){for(let t=0;t<this._o.length;t++)s[t]||(s[t]=Matrix.zeros(this._o[t].rows,this._o[t].cols));let t=s[0];for(let i=1;i<s.length;i++)t=t.concat(s[i],this._axis);return t}toObject(){return{type:"split",axis:this._axis,size:this._size}}}SplitLayer.registLayer();