var _=Object.defineProperty;var h=(s,t)=>_(s,"name",{value:t,configurable:!0});import p from"./base.js";export default class r extends p{static{h(this,"SwishLayer")}constructor({beta:t=1,...a}){super(a),this._beta=t}calc(t){this._i=t;const a=t.copy();return a.map(e=>e/(1+Math.exp(-this._beta*e))),a}grad(t){this._bo=t;const a=t.copy();return a.broadcastOperate(this._i,(e,i)=>e*(1+i*this._beta*Math.exp(-this._beta*i)/(1+Math.exp(-this._beta*i)))/(1+Math.exp(-this._beta*i))),a}update(t){let a=0;for(let e=0;e<this._i.length;e++)a+=this._bo.value[e]*(this._i.value[e]*Math.exp(-this._beta*this._i.value[e])/(1+Math.exp(-this._beta*this._i.value[e]))**2);this._beta-=t.delta("beta",a/this._i.length)}toObject(){return{type:"swish",beta:this._beta}}}r.registLayer();
