import Layer from"./base.js";export default class SwishLayer extends Layer{constructor({beta:t=1,...e}){super(e),this._beta=t}calc(t){this._i=t;const e=t.copy();return e.map((t=>t/(1+Math.exp(-this._beta*t)))),e}grad(t){this._bo=t;const e=t.copy();return e.broadcastOperate(this._i,((t,e)=>t*(1+e*this._beta*Math.exp(-this._beta*e)/(1+Math.exp(-this._beta*e)))/(1+Math.exp(-this._beta*e)))),e}update(t){let e=0;for(let t=0;t<this._i.length;t++)e+=this._bo.value[t]*(this._i.value[t]*Math.exp(-this._beta*this._i.value[t])/(1+Math.exp(-this._beta*this._i.value[t]))**2);this._beta-=t.delta("beta",e/this._i.length)}toObject(){return{type:"swish",beta:this._beta}}}SwishLayer.registLayer();