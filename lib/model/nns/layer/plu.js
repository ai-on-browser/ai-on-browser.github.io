import Layer from"./base.js";export default class PiecewiseLinearUnitLayer extends Layer{constructor({alpha:t=.1,c:a=1,...i}){super(i),this._alpha=t,this._c=a}calc(t){this._i=t;const a=t.copy();return a.map((t=>Math.max(this._alpha*(t+this._c)-this._c,Math.min(this._alpha*(t-this._c)+this._c,t)))),a}grad(t){const a=t.copy();return a.broadcastOperate(this._i,((t,a)=>t*(a<this._alpha*(a+this._c)-this._c||this._alpha*(a-this._c)+this._c<a?this._alpha:1))),a}toObject(){return{type:"plu",alpha:this._alpha,c:this._c}}}PiecewiseLinearUnitLayer.registLayer("plu");