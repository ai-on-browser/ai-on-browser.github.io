var _=Object.defineProperty;var s=(h,a)=>_(h,"name",{value:a,configurable:!0});import p from"./base.js";export default class l extends p{static{s(this,"ParametricRectifiedExponentialUnitLayer")}constructor({alpha:a=1,beta:e=1,...i}){super(i),this._alpha=a,this._beta=e}calc(a){this._i=a;const e=a.copy();return e.map(i=>this._alpha*i*(i>0?1:Math.exp(this._beta*i))),e}grad(a){this._bo=a;const e=a.copy();return e.broadcastOperate(this._i,(i,t)=>i*this._alpha*(t>0?1:(1+t*this._beta)*Math.exp(this._beta*t))),e}update(a){let e=0,i=0;for(let t=0;t<this._i.length;t++)this._i.value[t]>0?e+=this._bo.value[t]*this._i.value[t]:(e+=this._bo.value[t]*(this._i.value[t]*Math.exp(this._beta*this._i.value[t])),i+=this._bo.value[t]*(this._alpha*this._i.value[t]**2*Math.exp(this._beta*this._i.value[t])));this._alpha-=a.delta("alpha",e/this._i.length),this._beta-=a.delta("beta",i/this._i.length)}toObject(){return{type:"preu",alpha:this._alpha,beta:this._beta}}}l.registLayer("preu");
