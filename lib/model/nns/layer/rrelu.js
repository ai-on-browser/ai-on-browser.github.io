var l=Object.defineProperty;var n=(e,t)=>l(e,"name",{value:t,configurable:!0});import _ from"./base.js";import a from"../../../util/tensor.js";export default class h extends _{static{n(this,"RandomizedReLULayer")}constructor({l:t=1/8,u:s=1/3,...i}){super(i),this._l=t,this._u=s,this._r=null,this._training=!1}bind({training:t}){this._training=t}calc(t){this._training?this._r=a.random(t.sizes.slice(1),this._l,this._u):this._r=new a(t.sizes.slice(1),(this._l+this._u)/2),this._i=t;const s=t.copy();return s.map((i,r)=>i>0?i:i*this._r.at(r.slice(1))),s}grad(t){const s=t.copy();return s.map((i,r)=>this._i.at(r)>0?i:i*this._r.at(r.slice(1))),s}toObject(){return{type:"rrelu",l:this._l,u:this._u}}}h.registLayer("rrelu");
