import Layer from"./base.js";export default class MinLayer extends Layer{calc(...e){this._i=e;const t=e[0].copy();for(let r=1;r<e.length;r++)t.broadcastOperate(e[r],((e,t)=>Math.min(e,t)));return t}grad(e){const t=this._i.map((e=>{const t=e.copy();return t.fill(0),t})),r=Array(e.sizes.length).fill(0);do{let s=1/0,a=null,i=-1;for(let e=0;e<t.length;e++){const t=r.map(((t,r)=>t%this._i[e].sizes[r])),l=this._i[e].at(t);s>l&&(s=l,a=t,i=e)}t[i].operateAt(a,(t=>t+e.at(r)));for(let t=0;t<r.length&&(r[t]++,!(r[t]<e.sizes[t]));t++)r[t]=0}while(r.some((e=>e>0)));return t}}MinLayer.registLayer();