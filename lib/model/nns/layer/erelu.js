var c=Object.defineProperty;var a=(e,s)=>c(e,"name",{value:s,configurable:!0});import l from"./base.js";import n from"../../../util/tensor.js";export default class o extends l{static{a(this,"ElasticReLULayer")}constructor({...s}){super(s),this._r=null,this._training=!1}bind({training:s}){this._training=s}calc(s){this._i=s;const t=s.copy();return this._training?(this._r=n.random(s.sizes.slice(1),0,2),t.map((i,r)=>i>0?i*this._r.at(r.slice(1)):0)):(this._r=n.ones(s.sizes.slice(1)),t.map(i=>i>0?i:0)),t}grad(s){const t=s.copy();return t.map((i,r)=>this._i.at(r)>0?i*this._r.at(r.slice(1)):0),t}}o.registLayer("erelu");
