import Layer from"./base.js";import Tensor from"../../../util/tensor.js";export default class ElasticReLULayer extends Layer{constructor({...s}){super(s),this._r=null,this._training=!1}bind({training:s}){this._training=s}calc(s){this._i=s;const r=s.copy();return this._training?(this._r=Tensor.random(s.sizes.slice(1),0,2),r.map(((s,r)=>s>0?s*this._r.at(r.slice(1)):0))):(this._r=Tensor.ones(s.sizes.slice(1)),r.map((s=>s>0?s:0))),r}grad(s){const r=s.copy();return r.map(((s,r)=>this._i.at(r)>0?s*this._r.at(r.slice(1)):0)),r}}ElasticReLULayer.registLayer("erelu");