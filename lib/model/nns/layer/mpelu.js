var _=Object.defineProperty;var s=(i,t)=>_(i,"name",{value:t,configurable:!0});import p from"./base.js";export default class l extends p{static{s(this,"MultipleParametricELULayer")}constructor({alpha:t=1,beta:e=1,...h}){super(h),this._alpha=t,this._beta=e}calc(t){this._i=t;const e=t.copy();return e.map(h=>h>0?h:this._alpha*(Math.exp(this._beta*h)-1)),e}grad(t){this._bo=t;const e=t.copy();return e.broadcastOperate(this._i,(h,a)=>h*(a>0?1:this._alpha*this._beta*Math.exp(this._beta*a))),e}update(t){let e=0,h=0;for(let a=0;a<this._i.length;a++)this._i.value[a]>0||(e+=this._bo.value[a]*(Math.exp(this._beta*this._i.value[a])-1),h+=this._bo.value[a]*(this._alpha*this._i.value[a]*Math.exp(this._beta*this._i.value[a])));this._alpha-=t.delta("alpha",e/this._i.length),this._beta-=t.delta("beta",h/this._i.length)}toObject(){return{type:"mpelu",alpha:this._alpha,beta:this._beta}}}l.registLayer("mpelu");
