var c=Object.defineProperty;var f=(d,e)=>c(d,"name",{value:e,configurable:!0});export default class u{static{f(this,"GSOM")}constructor(e=.1,i=.1){this._sf=e,this._lr=this._init_lr=i,this._k=0,this._node=null,this._init_vector_count=4,this._lr_update=(h,s)=>h*.99}get size(){return this._node.length}fit(e){if(!this._node){this._d=e[0].length,this._node=[];for(let i=0;i<this._init_vector_count;i++){this._node[i]=[];for(let h=0;h<this._d;h++)this._node[i][h]=Math.random()}this._gt=-this._d*Math.log(this._sf),this._err=Array(this._node.length).fill(0)}for(let i=0;i<e.length;i++){this._k++;let h=1/0,s=-1;for(let t=0;t<this._node.length;t++){const n=this._node[t].reduce((r,l,o)=>r+(l-e[i][o])**2,0);n<h&&(h=n,s=t)}let _=0;for(let t=0;t<e[i].length;t++)this._node[s][t]+=this._lr*(e[i][t]-this._node[s][t]),_+=(e[i][t]-this._node[s][t])**2;this._err[s]+=Math.sqrt(_),this._err[s]>this._gt&&(this._node.push(this._node[s].map(t=>t+(Math.random()-.5)/1e3)),this._err.push(0),this._err[s]=0,this._lr=this._init_lr,this._k=1),this._lr=this._lr_update(this._lr,this._k)}}predict(e){const i=[];for(let h=0;h<e.length;h++){let s=1/0,_=-1;for(let t=0;t<this._node.length;t++){const n=this._node[t].reduce((r,l,o)=>r+(l-e[h][o])**2,0);n<s&&(s=n,_=t)}i[h]=_}return i}}
