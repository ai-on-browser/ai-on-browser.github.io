export default class SelectiveSamplingWinnow{constructor(t,h=2){this._b=t,this._alpha=h,this._w=null}fit(t,h){this._w||(this._w=Array(t[0].length).fill(1/t[0].length));for(let e=0;e<t.length;e++){const i=t[e].reduce(((t,h,e)=>t+h*this._w[e]),0),s=i<=0?-1:1;if(Math.random()<this._b/(this._b+Math.abs(i))&&h[e]!==s){let i=0;for(let s=0;s<this._w.length;s++)this._w[s]*=Math.exp(t[e][s]*h[e]*this._alpha),i+=this._w[s];for(let t=0;t<this._w.length;t++)this._w[t]/=i}}}predict(t){const h=[];for(let e=0;e<t.length;e++){const i=t[e].reduce(((t,h,e)=>t+h*this._w[e]),0);h[e]=i<=0?-1:1}return h}}