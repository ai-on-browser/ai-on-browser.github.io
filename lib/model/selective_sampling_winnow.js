import Matrix from"../util/matrix.js";export default class SelectiveSamplingWinnow{constructor(t,i=2){this._b=t,this._alpha=i}init(t,i){this._x=Matrix.fromArray(t),this._y=i,this._epoch=0,this._w=Matrix.ones(this._x.cols,1),this._w.div(this._x.cols)}fit(){const t=this._x.dot(this._w);t.map((t=>t<=0?-1:1)),this._epoch++;for(let i=0;i<this._x.rows;i++){const s=t.at(i,0),h=s<=0?-1:1;Math.random()<this._b/(this._b+Math.abs(s))&&this._y[i]!==h&&(this._w.mult(Matrix.map(this._x.row(i).t,(t=>Math.exp(t*this._y[i]*this._alpha)))),this._w.div(this._w.sum()))}}predict(t){return Matrix.fromArray(t).dot(this._w).value.map((t=>t<=0?-1:1))}}