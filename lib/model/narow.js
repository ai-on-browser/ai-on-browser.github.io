var l=Object.defineProperty;var n=(r,t)=>l(r,"name",{value:t,configurable:!0});import h from"../util/matrix.js";export default class u{static{n(this,"NAROW")}constructor(t=1){this._w=null,this._s=null,this._b=t}init(t,s){this._x=h.fromArray(t),this._c=this._x.mean(0),this._x.sub(this._c),this._y=s,this._d=this._x.cols,this._w=h.zeros(this._d,1),this._s=h.eye(this._d,this._d)}update(t,s){const o=this._w.tDot(t).toScaler();if(o*s>=1)return;const i=t.tDot(this._s).dot(t).toScaler(),e=i>1/this._b?i/(this._b*i-1):-1/0,c=1/(i+e),d=Math.max(0,1-s*o)*c,_=this._s.dot(t);this._w.add(h.mult(_,d*s));const a=_.dot(_.t);a.mult(c),this._s.sub(a)}fit(){for(let t=0;t<this._x.rows;t++)this.update(this._x.row(t).t,this._y[t])}predict(t){const s=h.fromArray(t);return s.sub(this._c),s.dot(this._w).value.map(i=>i<=0?-1:1)}}
