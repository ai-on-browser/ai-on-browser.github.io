import{Matrix}from"../util/math.js";export default class PhansalkarThresholding{constructor(t=3,h=.25,r=.5,s=2,a=10){this._n=t,this._k=h,this._r=r,this._p=s,this._q=a}predict(t){const h=Math.floor(this._n/2),r=[];for(let s=0;s<t.length;s++){r[s]=[];for(let a=0;a<t[s].length;a++){const e=[];for(let r=Math.max(0,s-h);r<=Math.min(t.length-1,s+h);r++)for(let i=Math.max(0,a-h);i<=Math.min(t[s].length-1,a+h);i++)e.push(t[r][i]);const i=Matrix.fromArray(e),n=i.mean(0),o=i.std(0);r[s][a]=n.value.map(((h,r)=>{const e=h*(1+this._p*Math.exp(-this._q*h)+this._k*(o.value[r]/this._r-1));return t[s][a][r]<e?0:255}))}}return r}}