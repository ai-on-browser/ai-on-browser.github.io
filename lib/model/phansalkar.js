export default class PhansalkarThresholding{constructor(t=3,h=.25,e=.5,s=2,r=10){this._n=t,this._k=h,this._r=e,this._p=s,this._q=r}predict(t){const h=Math.floor(this._n/2),e=[];for(let s=0;s<t.length;s++){e[s]=[];for(let r=0;r<t[s].length;r++){const n=[];for(let e=Math.max(0,s-h);e<=Math.min(t.length-1,s+h);e++)for(let l=Math.max(0,r-h);l<=Math.min(t[s].length-1,r+h);l++)n.push(t[e][l]);const l=n.reduce(((t,h)=>t+h),0)/n.length,a=Math.sqrt(n.reduce(((t,h)=>t+(h-l)**2),0)/n.length),i=l*(1+this._p*Math.exp(-this._q*l)+this._k*(a/this._r-1));e[s][r]=t[s][r]<i?0:255}}return e}}