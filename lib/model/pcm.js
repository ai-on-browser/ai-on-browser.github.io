var n=Object.defineProperty;var l=(c,h)=>n(c,"name",{value:h,configurable:!0});import o from"../util/matrix.js";export default class a{static{l(this,"PossibilisticCMeans")}constructor(h=2){this._m=h,this._c=[],this._u=[],this._k=1}_distance2(h,r){return h.reduce((s,_,t)=>s+(_-r[t])**2,0)}init(h){this._x=h}add(){let h=null;for(;;){const t=Math.floor(Math.random()*this._x.length);if(h=this._x[t],this._c.every(e=>this._distance2(h,e)>0))break}this._c.push(h.concat());const r=[],s=this._x.map(t=>this._distance2(h,t)),_=this._k*s.reduce((t,e)=>t+e,0)/s.length;for(let t=0;t<this._x.length;t++)r[t]=1/(1+(s[t]**2/_)**(1/(this._m-1)));this._u.push(r)}fit(){const h=this._x[0].length;for(let s=0;s<this._u.length;s++){const _=this._x.map(i=>this._distance2(this._c[s],i));let t=0,e=0;for(let i=0;i<this._x.length;i++)t+=this._u[s][i]**this._m,e+=_[i]*this._u[s][i]**this._m;e*=this._k/t;for(let i=0;i<this._x.length;i++)this._u[s][i]=1/(1+(_[i]/e)**(1/(this._m-1)))}const r=[];for(let s=0;s<this._u.length;s++){const _=Array(h).fill(0);let t=0;for(let e=0;e<this._x.length;e++){t+=this._u[s][e]**this._m;for(let i=0;i<h;i++)_[i]+=this._x[e][i]*this._u[s][e]**this._m}r.push(_.map(e=>e/t))}this._c=r}predict(){return o.fromArray(this._u).t.toArray()}}
