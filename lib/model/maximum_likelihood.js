import{Matrix}from"../util/math.js";export default class MaximumLikelihoodEstimator{constructor(t="normal"){this._distribution=t}fit(t){t=Matrix.fromArray(t),"normal"===this._distribution&&(this._m=t.mean(0),this._s=t.cov())}probability(t){if(t=Matrix.fromArray(t),"normal"===this._distribution){const i=Math.sqrt((2*Math.PI)**t.cols*this._s.det());t.sub(this._m);const r=t.dot(this._s.inv());r.mult(t);const s=r.sum(1);return s.map((t=>Math.exp(-t/2)/i)),s.value}}predict(t){return this.probability(t)}}