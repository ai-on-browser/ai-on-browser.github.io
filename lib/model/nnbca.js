var k=Object.defineProperty;var o=(d,n)=>k(d,"name",{value:n,configurable:!0});export default class p{static{o(this,"NNBCA")}constructor(n="euclid"){switch(this._metric=n,this._metric){case"euclid":this._d=(c,h)=>Math.sqrt(c.reduce((_,e,s)=>_+(e-h[s])**2,0));break;case"manhattan":this._d=(c,h)=>c.reduce((_,e,s)=>_+Math.abs(e-h[s]),0);break;case"chebyshev":this._d=(c,h)=>Math.max(...c.map((_,e)=>Math.abs(_-h[e])));break;case"minkowski":this._dp=2,this._d=(c,h)=>Math.pow(c.reduce((_,e,s)=>_+(e-h[s])**this._dp,0),1/this._dp);break}}fit(n,c){this._x=n,this._y=c,this._classes=[...new Set(c)];const h=this._x.length;this._distances=Array.from({length:h},()=>[]);for(let s=0;s<h;s++){this._distances[s][s]={i:s,d:0};for(let i=s+1;i<h;i++){const t=this._d(this._x[s],this._x[i]);this._distances[s][i]={i,d:t},this._distances[i][s]={i:s,d:t}}this._distances[s].sort((i,t)=>i.d-t.d)}this._g=Array.from({length:h},()=>[]),this._r=1;const _=Array.from({length:h},()=>[]);let e=[-1,0];for(;;){for(let i=0;i<h;i++){const t=this._distances[i][this._r+1].i;_[i].push(t),_[t].includes(i)&&!this._g[i][t]&&(this._g[i].push(t),this._g[t].push(i))}const s=this._g.reduce((i,t)=>i+(t.length===0?1:0),0);if(e[0]!==s?e=[s,1]:e[1]++,s===0||this._r>2&&e[1]>=Math.sqrt(this._r-e[1]))break;this._r++}this._t=[];for(let s=0;s<this._classes.length;s++){this._t[s]={s:0,c:0};const i=this._classes[s];for(let t=0;t<this._x.length;t++)this._y[t]===i&&(this._t[s].c++,this._g[t].length!==0&&(this._t[s].s+=this._g[t].reduce((r,a)=>r+this._y[a]===i?1:0,0)/this._g[t].length))}}predict(n){const c=Array(n.length).fill(null);for(let h=0;h<n.length;h++){const _=this._x.map((t,r)=>({i:r,d:this._d(t,n[h])}));_.sort((t,r)=>t.d-r.d);const e=[];for(let t=0;t<this._r;t++)_[t].d<this._distances[_[t].i][this._r+1].d&&e.push(_[t].i);if(e.length===0)continue;let s=0,i=-1;for(let t=0;t<this._classes.length;t++){const r=this._classes[t];let a=0;for(let l=0;l<this._classes.length;l++)if(t===l){const f=e.reduce((g,u)=>g+(this._y[u]===r?1:0),0)/e.length;a+=(this._t[l].s+f)/(this._t[l].c+1)}else this._t[l].c>0&&(a+=this._t[l].s/this._t[l].c);s<a&&(s=a,i=r)}c[h]=i}return c}}
