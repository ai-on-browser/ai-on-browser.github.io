import{Matrix}from"../util/math.js";export default class LeastAbsolute{constructor(){this._w=null}fit(t,r){t=Matrix.fromArray(t),r=Matrix.fromArray(r);const o=t.rows,s=t.resize(o,t.cols+1,1);null===this._w&&(this._w=Matrix.randn(s.cols,r.cols));const a=s.dot(this._w),i=r.copySub(a);i.map(Math.abs);const c=i.sum(1);c.map((t=>1/(t+1e-8)));const l=s.copyMult(c);this._w=l.tDot(s).solve(l.tDot(r))}predict(t){return(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1).dot(this._w).toArray()}}