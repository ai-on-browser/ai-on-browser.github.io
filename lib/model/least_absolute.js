import Matrix from"../util/matrix.js";export default class LeastAbsolute{constructor(){this._w=null}fit(t,r){t=Matrix.fromArray(t),r=Matrix.fromArray(r);const o=t.rows,s=t.resize(o,t.cols+1,1);null===this._w&&(this._w=Matrix.randn(s.cols,r.cols));const i=s.dot(this._w),l=r.copySub(i);l.map((t=>1/(Math.abs(t)+1e-8)));for(let t=0;t<this._w.cols;t++){const o=s.copyMult(l.col(t)),i=o.tDot(s).solve(o.tDot(r.col(t)));this._w.set(0,t,i)}}predict(t){return(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1).dot(this._w).toArray()}}