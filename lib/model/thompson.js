import{Matrix}from"../util/math.js";import{qt}from"./smirnov_grubbs.js";export default class Thompson{constructor(t){this._alpha=t}predict(t){const r=Matrix.fromArray(t),a=r.rows,s=Array(t.length).fill(!1);if(a<=2||this._alpha>a)return s;const o=r.mean(0),i=r.std(0);r.sub(o),r.abs(),r.div(i);const m=r.max(1),h=m.argmax(0).toScaler(),l=m.at(h,0),n=l*Math.sqrt((a-2)/(a-1-l**2)),c=this._alpha/a;return n>qt(a-2,c)&&(s[h]=!0),s}}