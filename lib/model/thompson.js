import Matrix from"../util/matrix.js";import{qt}from"./smirnov_grubbs.js";export default class Thompson{constructor(t){this._alpha=t}predict(t){const r=Matrix.fromArray(t),a=r.rows,s=Array(t.length).fill(!1);if(a<=2||this._alpha>a)return s;const o=r.mean(0),i=r.std(0);r.sub(o),r.abs(),r.div(i);const m=r.max(1),l=m.argmax(0).toScaler(),n=m.at(l,0),h=n*Math.sqrt((a-2)/(a-1-n**2)),c=this._alpha/a;return h>qt(a-2,c)&&(s[l]=!0),s}}