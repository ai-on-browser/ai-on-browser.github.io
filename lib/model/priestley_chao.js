var M=Object.defineProperty;var l=(p,n)=>M(p,"name",{value:n,configurable:!0});import _ from"../util/matrix.js";export default class f{static{l(this,"PriestleyChao")}constructor(n){this._h=n,this._p=o=>{const r=Math.sqrt(2*Math.PI)**o.cols,s=_.mult(o,o).sum(1);return s.map(c=>Math.exp(-c/2)/r),s}}fit(n,o){if(!this._h){const t=n.length,s=n.map(i=>Math.sqrt(i.reduce((h,a)=>h+a**2,0))),c=s.reduce((i,h)=>i+h,0)/t,e=Math.sqrt(s.reduce((i,h)=>i+(h-c)**2,0)/t);s.sort((i,h)=>i-h);const m=l(i=>{const h=(t-1)*i,a=Math.floor(h),d=Math.ceil(h);return s[a]+(h-a)*(s[d]-s[a])},"q"),u=Math.min(e,(m(.75)-m(.25))/1.34);this._h=1.06*u/t**.2}const r=n.map((t,s)=>[t[0],o[s]]);r.sort((t,s)=>t[0]-s[0]),this._x=_.fromArray(r.map(t=>t[0])),this._x2=this._x.slice(1),this._xd=_.sub(this._x2,this._x.slice(0,n.length-1)),this._y=r.map(t=>t[1])}predict(n){const o=this._x2.rows;return n.map(r=>{const t=_.sub(this._x2,new _(1,1,r[0]));t.div(this._h);const s=this._p(t);s.mult(this._xd);let c=0;for(let e=0;e<o;e++)c+=this._y[e][0]*s.value[e];return c/this._h})}}
