import Matrix from"../util/matrix.js";export default class PoissonRegression{constructor(r){this._w=null,this._r=r}fit(r,t){r=(r=Matrix.fromArray(r)).resize(r.rows,r.cols+1,1),t=Matrix.fromArray(t),this._w||(this._w=Matrix.randn(r.cols,t.cols));const s=r.tDot(t),o=r.dot(this._w);o.map((r=>Math.exp(r))),s.sub(r.tDot(o)),s.mult(this._r/r.rows),this._w.add(s)}predict(r){return(r=(r=Matrix.fromArray(r)).resize(r.rows,r.cols+1,1)).dot(this._w).copyMap((r=>Math.exp(r))).toArray()}}