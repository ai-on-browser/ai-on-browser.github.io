import{Matrix}from"../util/math.js";export default class PoissonRegression{constructor(t){this._w=null,this._r=t}fit(t,r){t=(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1),r=Matrix.fromArray(r),this._w||(this._w=Matrix.randn(t.cols,r.cols));const s=t.tDot(r),o=t.dot(this._w);o.map((t=>Math.exp(t))),s.sub(t.tDot(o)),s.mult(this._r/t.rows),this._w.add(s)}predict(t){return(t=(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1)).dot(this._w).copyMap((t=>Math.exp(t))).toArray()}}