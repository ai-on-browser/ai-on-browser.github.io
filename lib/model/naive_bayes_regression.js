var m=Object.defineProperty;var y=(u,e)=>m(u,"name",{value:e,configurable:!0});export default class d{static{y(this,"NaiveBayesRegression")}constructor(e){this._iscat=e,this._categories=[],this._hx=[],this._hy=[],this._hk=[],this._c_cand=[.4,.5,.6,.7,.8],this._d=50,this._h=null}_gaussian(e){return Math.exp(-(e**2)/2)/Math.sqrt(2*Math.PI)}fit(e,f){this._x=e,this._y=f;const s=e.length;for(let t=0;t<this._iscat.length;t++){const r=e.map(h=>h[t]);if(this._iscat[t]){this._categories[t]={};for(let h=0;h<s;h++)this._categories[t][r[h]]||(this._categories[t][r[h]]=0),this._categories[t][r[h]]++;this._hk[t]={};for(const h of Object.keys(this._categories[t])){let l=1/0;this._hk[t][h]=1;for(const c of this._c_cand){const o=c/Math.sqrt(this._categories[t][h]);let a=0;for(let i=0;i<s;i++){if(r[i]!==h)continue;let n=0;for(let _=0;_<s;_++)i===_||r[_]!==h||(n+=this._gaussian((f[_]-f[i])/o));a+=Math.log(n/((s-1)*o))}-a/s<l&&(l=-a/s,this._hk[t][h]=o)}}}else{let h=1/0;this._hx[t]=0,this._hy[t]=0;for(const l of this._c_cand){const c=l/Math.sqrt(s);for(const o of this._c_cand){const a=o/Math.sqrt(s);let i=0;for(let n=0;n<s;n++){let _=0;for(let g=0;g<s;g++)n!==g&&(_+=this._gaussian((r[g]-r[n])/c)*this._gaussian((f[g]-f[n])/a));i+=Math.log(_/((s-1)*c*a))}-i/s<h&&(h=-i/s,this._hx[t]=c,this._hy[t]=a)}}}}this._ymax=-1/0,this._ymin=1/0;for(let t=0;t<s;t++)this._ymax=Math.max(this._ymax,f[t]),this._ymin=Math.min(this._ymin,f[t]);this._h=(this._ymax-this._ymin)/(this._d-1)}predict(e){const f=[],s=this._x.length;for(let t=0;t<e.length;t++){const r=[],h=[];for(let c=-Math.floor(this._d/2);c<=Math.ceil(this._d*1.5);c++){const o=this._ymin+this._h*c;let a=1;for(let i=0;i<this._iscat.length;i++)if(this._iscat[i]){let n=0;for(let _=0;_<s;_++)e[t][i]===this._x[_][i]&&(n+=this._gaussian((o-this._y[_])/this._hk[i][e[t][i]]));a*=n/(s*this._hk[i][e[t][i]])}else{let n=0;for(let _=0;_<s;_++)n+=this._gaussian((e[t][i]-this._x[_][i])/this._hx[i])*this._gaussian((o-this._y[_])/this._hy[i]);a*=n/(s*this._hx[i]*this._hy[i])}r.push(a),h.push(o)}const l=r.reduce((c,o)=>c+o,0);f[t]=r.reduce((c,o,a)=>c+o*h[a],0)/l}return f}}
