import Matrix from"../util/matrix.js";export default class QuantileRegression{constructor(t=.5){this._tau=t,this._w=null}fit(t,r,a=.1){t=Matrix.fromArray(t),r=Matrix.fromArray(r);const i=t.rows,s=Matrix.resize(t,i,t.cols+1,1);null===this._w&&(this._w=Matrix.randn(s.cols,r.cols));const o=s.dot(this._w),l=Matrix.sub(r,o),u=Matrix.map(l,(t=>t<=0?1:0)),x=Matrix.sub(u,this._tau);x.map((t=>Math.abs(t))),x.mult(Matrix.map(l,(t=>Math.sign(t))));const M=s.tDot(x);M.mult(a),this._w.add(M)}predict(t){t=Matrix.fromArray(t);return Matrix.resize(t,t.rows,t.cols+1,1).dot(this._w).toArray()}}