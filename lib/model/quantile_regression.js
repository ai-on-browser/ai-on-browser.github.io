import{Matrix}from"../util/math.js";export default class QuantileRegression{constructor(t=.5,r=.1){this._tau=t,this._lr=r,this._w=null}set lr(t){this._lr=t}fit(t,r){t=Matrix.fromArray(t),r=Matrix.fromArray(r);const s=t.rows,o=t.resize(s,t.cols+1,1);null===this._w&&(this._w=Matrix.randn(o.cols,r.cols));const i=o.dot(this._w),a=r.copySub(i),l=a.copyMap((t=>t<=0?1:0)).copySub(this._tau);l.map((t=>Math.abs(t))),l.mult(a.copyMap((t=>Math.sign(t))));const c=o.tDot(l);c.mult(this._lr),this._w.add(c)}predict(t){return(t=Matrix.fromArray(t)).resize(t.rows,t.cols+1,1).dot(this._w).toArray()}}