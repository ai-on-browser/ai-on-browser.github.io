import Matrix from"../util/matrix.js";export default class QuantileRegression{constructor(t=.5,r=.1){this._tau=t,this._lr=r,this._w=null}set lr(t){this._lr=t}fit(t,r){t=Matrix.fromArray(t),r=Matrix.fromArray(r);const s=t.rows,i=Matrix.resize(t,s,t.cols+1,1);null===this._w&&(this._w=Matrix.randn(i.cols,r.cols));const a=i.dot(this._w),o=Matrix.sub(r,a),l=Matrix.map(o,(t=>t<=0?1:0)),h=Matrix.sub(l,this._tau);h.map((t=>Math.abs(t))),h.mult(Matrix.map(o,(t=>Math.sign(t))));const u=i.tDot(h);u.mult(this._lr),this._w.add(u)}predict(t){t=Matrix.fromArray(t);return Matrix.resize(t,t.rows,t.cols+1,1).dot(this._w).toArray()}}