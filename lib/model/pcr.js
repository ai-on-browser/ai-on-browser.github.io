import Matrix from"../util/matrix.js";import{PCA}from"./pca.js";export default class PCR{constructor(){this._pca=new PCA,this._rd=0}fit(r,t){r=Matrix.fromArray(r),t=Matrix.fromArray(t),this._pca.fit(r);const i=Matrix.fromArray(this._pca.predict(r,this._rd));i.resize(i.rows,i.cols+1,1);const o=i.tDot(i);this._w=o.solve(i.t).dot(t)}predict(r){r=Matrix.fromArray(r);const t=Matrix.fromArray(this._pca.predict(r,this._rd));return t.resize(t.rows,t.cols+1,1),t.dot(this._w).toArray()}}