import Matrix from"../util/matrix.js";export default class ADALINE{constructor(t){this._r=t,this._a=t=>t}init(t,i){this._x=Matrix.fromArray(t),this._y=Matrix.fromArray(i),this._epoch=0,this._w=Matrix.randn(this._x.cols,1),this._b=0}fit(){const t=this._x.dot(this._w);t.map((t=>this._a(t+this._b)));const i=this._y.copySub(t),s=this._x.tDot(i);s.mult(this._r/this._x.rows),this._w.add(s),this._b+=i.sum()*this._r/this._x.rows}predict(t){return Matrix.fromArray(t).dot(this._w).value.map((t=>this._a(t+this._b)<=0?-1:1))}}