var d=Object.defineProperty;var l=(_,s)=>d(_,"name",{value:s,configurable:!0});const m={gaussian:l((_,s,h)=>Math.exp(-(_**2)/(2*s**2))/(s*Math.sqrt(2*Math.PI))**h,"gaussian"),epanechnikov:l((_,s,h)=>3*(1-(_/s)**2)/(4*s**h),"epanechnikov")};export default class k{static{l(this,"KDEOS")}constructor(s,h,e="gaussian"){this._kmin=s,this._kmax=h,this._e=1/0,this._phi=.1,typeof e=="function"?this._kernel=e:(typeof e=="string"&&(e={name:e}),this._kernel=m[e.name])}_distance(s,h){return Math.sqrt(s.reduce((e,f,a)=>e+(f-h[a])**2,0))}_cdf(s){return 1/(1+Math.exp(-1.7*s))}predict(s){const h=s.length,e=[];for(let t=0;t<h;t++){e[t]=[],e[t][t]={d:0,i:t};for(let i=0;i<t;i++){const o=this._distance(s[t],s[i]);e[t][i]={d:o,i},e[i][t]={d:o,i:t}}}for(let t=0;t<h;t++)e[t].sort((i,o)=>i.d-o.d);const f=[],a=s[0].length;for(let t=0;t<h;t++){f[t]=[];for(let i=this._kmin;i<=this._kmax;i++){let o=0;for(let n=0;n<i;n++)o+=e[t][n+1].d;const c=Math.min(o/i,this._e);f[t][i]=0;for(let n=0;n<i;n++)f[t][i]+=this._kernel(e[t][n+1].d,c,a)}}const r=[];for(let t=0;t<h;t++){r[t]=0;for(let i=this._kmin;i<=this._kmax;i++){let o=0;for(let n=0;n<i;n++)o+=f[e[t][n+1].i][i];o/=i;let c=0;for(let n=0;n<i;n++)c+=(f[e[t][n+1].i][i]-o)**2;c=Math.sqrt(c/i),r[t]+=(o-f[t][i])/c}r[t]/=this._kmax-this._kmin+1}for(let t=0;t<h;t++)r[t]=1-this._cdf(r[t]),r[t]=this._phi*(1-r[t])/(this._phi+r[t]);return r}}
