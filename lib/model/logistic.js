var b=Object.defineProperty;var p=(l,s)=>b(l,"name",{value:s,configurable:!0});import c from"../util/matrix.js";export class LogisticRegression{static{p(this,"LogisticRegression")}constructor(){this._W=null,this._b=0}_output(s){const t=s.dot(this._W);return t.add(this._b),t}fit(s,t,o=1,n=.1,a=0,h=0){s=c.fromArray(s),t=c.fromArray(t),this._W||(this._W=c.randn(s.cols,1));const m=s.rows;for(let u=0;u<o;u++){const d=this._output(s);d.sub(t);const r=s.tDot(d);r.div(m),(a>0||h>0)&&r.map(e=>e+e*h+Math.sign(e)*a),r.mult(n),this._W.sub(r);let i=d.mean();(a>0||h>0)&&(i+=i*h+Math.sign(i)*a),this._b-=i*n}}predict(s){const o=c.fromArray(s).dot(this._W);return o.add(this._b),o.value.map(n=>n>=0?1:-1)}}export class MultinomialLogisticRegression{static{p(this,"MultinomialLogisticRegression")}constructor(s){this._classes=s,this._W=null,this._b=null}_output(s){const t=s.dot(this._W);return t.add(this._b),t.map(Math.exp),t.div(t.sum(1)),t}fit(s,t,o=1,n=.1,a=0,h=0){const m=s.length;this._classes||(this._classes=[...new Set(t)]);const u=c.fromArray(s),d=new c(m,this._classes.length);t.forEach((r,i)=>d.set(i,this._classes.indexOf(r),1)),this._W||(this._W=c.randn(u.cols,this._classes.length),this._b=c.randn(1,this._classes.length));for(let r=0;r<o;r++){const i=this._output(u);i.sub(d);const e=u.tDot(i);e.div(m),(a>0||h>0)&&e.map(_=>_+_*h+Math.sign(_)*a),e.mult(n),this._W.sub(e);const f=i.mean(0);(a>0||h>0)&&f.map(_=>_+_*h+Math.sign(_)*a),f.mult(n),this._b.sub(f)}}predict(s){const o=c.fromArray(s).dot(this._W);return o.add(this._b),o.argmax(1).value.map(n=>this._classes[n])}}
