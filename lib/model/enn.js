var x=Object.defineProperty;var o=(f,n)=>x(f,"name",{value:n,configurable:!0});export default class k{static{o(this,"ENN")}constructor(n=1,_=5,i="euclid"){switch(this._k=_,this._v=n,this._metric=i,this._metric){case"euclid":this._d=(l,h)=>Math.sqrt(l.reduce((t,s,e)=>t+(s-h[e])**2,0));break;case"manhattan":this._d=(l,h)=>l.reduce((t,s,e)=>t+Math.abs(s-h[e]),0);break;case"chebyshev":this._d=(l,h)=>Math.max(...l.map((t,s)=>Math.abs(t-h[s])));break;case"minkowski":this._dp=2,this._d=(l,h)=>Math.pow(l.reduce((t,s,e)=>t+(s-h[e])**this._dp,0),1/this._dp);break}}fit(n,_){this._x=n,this._c=_,this._classes=[...new Set(this._c)],this._nears=[],this._n=Array(this._classes.length).fill(0);for(let i=0;i<this._x.length;i++){const l=this._x.map((h,t)=>({d:this._d(this._x[i],h),idx:t}));l.sort((h,t)=>h.d-t.d),this._nears[i]=l,this._n[this._classes.indexOf(this._c[i])]++}if(this._v>=1){this._t=[];for(let i=0;i<this._classes.length;i++){let l=0;for(let h=0;h<this._nears.length;h++)if(this._c[h]===this._classes[i])for(let t=1;t<=this._k;t++)this._c[this._nears[h][t].idx]===this._classes[i]&&l++;this._t[i]=l/(this._n[i]*this._k)}}}predict(n){const _=[];for(let i=0;i<n.length;i++)this._v===0?_[i]=this._predict0(n[i]):this._v===1?_[i]=this._predict1(n[i]):this._v===2&&(_[i]=this._predict2(n[i]));return _}_predict0(n){const _=[],i=[{d:0,idx:-1}];for(let t=0;t<this._x.length;t++){const s=this._d(n,this._x[t]);i.push({d:s,idx:t}),_[t]=[];let e=!1;for(let a=0;a<this._nears[t].length;a++)!e&&s<this._nears[t][a].d&&(_[t].push({d:s,idx:-1}),e=!0),_[t].push(this._nears[t][a])}i.sort((t,s)=>t.d-s.d),_.push(i);let l=-1,h=0;for(let t=0;t<this._classes.length;t++){let s=0;for(let e=0;e<this._classes.length;e++){let a=0;for(let c=0;c<_.length;c++){if(c<this._c.length){if(this._c[c]!==this._classes[e])continue}else if(t!==e)continue;for(let d=1;d<=this._k;d++)_[c][d].idx<0?t===e&&a++:this._c[_[c][d].idx]===this._classes[e]&&a++}const r=this._n[e]+(t===e?1:0);s+=a/(r*this._k)}h<s&&(h=s,l=t)}return this._classes[l]}_predict1(n){const _=[{d:0,idx:-1}],i=[];for(let t=0;t<this._x.length;t++){const s=this._d(n,this._x[t]);_.push({d:s,idx:t}),i[t]=s}_.sort((t,s)=>t.d-s.d);let l=-1/0,h=-1;for(let t=0;t<this._classes.length;t++){let s=0;for(let e=0;e<this._classes.length;e++){let a=0;for(let c=1;c<=this._k;c++)this._c[_[c].idx]===this._classes[e]&&a++;let r=0;for(let c=0;c<this._nears.length;c++)i[c]<this._nears[c][this._k].d&&(t===e&&this._c[this._nears[c][this._k].idx]!==this._classes[e]||t!==e&&this._c[this._nears[c][this._k].idx]===this._classes[e])&&r++;t===e?s+=(r+a-this._k*this._t[e])/((this._n[e]+1)*this._k):s-=r/(this._n[e]*this._k)}l<s&&(l=s,h=t)}return this._classes[h]}_predict2(n){const _=[{d:0,idx:-1}],i=[];for(let t=0;t<this._x.length;t++){const s=this._d(n,this._x[t]);_.push({d:s,idx:t}),i[t]=s}_.sort((t,s)=>t.d-s.d);let l=-1/0,h=-1;for(let t=0;t<this._classes.length;t++){let s=0;for(let r=1;r<=this._k;r++)this._c[_[r].idx]===this._classes[t]&&s++;let e=0;for(let r=0;r<this._nears.length;r++)i[r]<this._nears[r][this._k].d&&e++;const a=e+s-this._k*this._t[t];l<a&&(l=a,h=t)}return this._classes[h]}}
