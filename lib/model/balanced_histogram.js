export default class BalancedHistogramThresholding{constructor(t=500){this._minCount=t,this._count=200}predict(t){const o=t.reduce(((t,o)=>Math.max(t,o)),-1/0),i=t.reduce(((t,o)=>Math.min(t,o)),1/0),n=Array(this._count).fill(0),e=(o-i)/this._count;for(let h=0;h<t.length;h++)t[h]===o?n[this._count-1]++:n[Math.floor((t[h]-i)/e)]++;let h=0,r=n.length-1;for(;n[h]<this._minCount;)if(h++,h>=n.length)throw"'minCount' is too large.";for(;n[r]<this._minCount;)r--;let l=Math.ceil((h+r)/2),s=0,c=0;for(let t=h;t<r+1;t++)t<l?s+=n[t]:c+=n[t];for(;h<r;){s>c?s-=n[h++]:c-=n[r--];const t=Math.ceil((h+r)/2);t<l?(s-=n[l-1],c+=n[l-1]):t>l&&(s+=n[l],c-=n[l]),l=t}return this._t=l*e+i,t.map((t=>t<this._t?0:1))}}