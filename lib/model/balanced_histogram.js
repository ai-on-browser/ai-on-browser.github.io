export default class BalancedHistogramThresholding{constructor(t=500){this._minCount=t}predict(t){const o=200,e=t.reduce(((t,o)=>Math.max(t,o)),-1/0),r=t.reduce(((t,o)=>Math.min(t,o)),1/0),n=Array(o).fill(0);for(let i=0;i<t.length;i++)t[i]===e?n[199]++:n[Math.floor((t[i]-r)/(e-r)*o)]++;let i=0,l=n.length-1;for(;n[i]<this._minCount;)if(i++,i>=n.length)throw"'minCount' is too large.";for(;n[l]<this._minCount;)l--;let h=Math.ceil((i+l)/2),a=0,s=0;for(let t=i;t<l+1;t++)t<h?a+=n[t]:s+=n[t];for(;i<l;){a>s?a-=n[i++]:s-=n[l--];const t=Math.ceil((i+l)/2);t<h?(a-=n[h-1],s+=n[h-1]):t>h&&(a+=n[h],s-=n[h]),h=t}return this._t=h*(e-r)/o+r,t.map((t=>t<h?0:1))}}