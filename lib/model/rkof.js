var m=Object.defineProperty;var a=(c,i)=>m(c,"name",{value:i,configurable:!0});const x={gaussian:a(()=>c=>Math.exp(-c.reduce((i,e)=>i+e**2,0)/2)/Math.sqrt(2*Math.PI)**c.length,"gaussian"),epanechnikov:a(()=>c=>{const i=c.reduce((e,s)=>e+s**2,0);return i>1?0:.75**c.length*(1-i)},"epanechnikov"),volcano:a(({beta:c=1})=>i=>{const e=i.reduce((s,n)=>s+n**2,0);return e<=1?c:c*Math.exp(-e+1)},"volcano")};export default class y{static{a(this,"RKOF")}constructor(i,e,s,n="gaussian"){this._k=i,this._h=e,this._alpha=s,this._s=1,typeof n=="function"?this._kernel=n:(typeof n=="string"&&(n={name:n}),this._kernel=x[n.name](n))}_distance(i,e){return Math.sqrt(i.reduce((s,n,l)=>s+(n-e[l])**2,0))}predict(i){const e=i.length,s=[];for(let t=0;t<e;t++){s[t]=[],s[t][t]={d:0,i:t};for(let o=0;o<t;o++){const h=this._distance(i[t],i[o]);s[t][o]={d:h,i:o},s[o][t]={d:h,i:t}}}const n=[];let l=0;for(let t=0;t<e;t++)s[t].sort((o,h)=>o.d-h.d),n[t]=s[t][this._k+1].d,l+=Math.log(1/n[t]);l/=e;const u=Math.exp(l),g=this._h*u**this._alpha,r=[],f=[];for(let t=0;t<e;t++){r[t]=0,f[t]=1/0;for(let o=1;o<=this._k;o++){const h=g*n[s[t][o].i]**this._alpha,d=i[s[t][o].i].map((k,M)=>(i[t][M]-k)/h);r[t]+=this._kernel(d)/h**2,f[t]=Math.min(f[t],n[s[t][o].i])}r[t]/=this._k}const _=[];for(let t=0;t<e;t++){_[t]=0;let o=0;for(let h=1;h<=this._k;h++){const d=Math.exp(-((n[s[t][h].i]/f[t]-1)**2)/(2*this._s**2));_[t]+=d*r[s[t][h].i],o+=d}_[t]/=o}const p=[];for(let t=0;t<e;t++)r[t]===0?p[t]=1/0:p[t]=_[t]/r[t];return p}}
