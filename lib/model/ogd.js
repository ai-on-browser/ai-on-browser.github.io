export default class OnlineGradientDescent{constructor(t=1,s="zero_one"){this._c=t,this._w=null,this._w0=0,this._t=1,"zero_one"===s&&(this._loss=(t,s)=>t===s?0:1)}update(t,s){const i=Math.sign(this._w.reduce(((s,i,e)=>s+i*t[e]),this._w0));if(0===this._loss(s,i))return;const e=this._c/Math.sqrt(this._t);for(let i=0;i<this._w.length;i++)this._w[i]+=e*s*t[i];this._w0+=e*s,this._t++}fit(t,s){this._w||(this._w=Array(t[0].length).fill(0),this._w0=0);for(let i=0;i<t.length;i++)this.update(t[i],s[i])}predict(t){const s=[];for(let i=0;i<t.length;i++){const e=t[i].reduce(((t,s,i)=>t+s*this._w[i]),this._w0);s[i]=e<=0?-1:1}return s}}