var f=Object.defineProperty;var l=(o,_)=>f(o,"name",{value:_,configurable:!0});export default class c{static{l(this,"AffinityPropagation")}constructor(){this._epoch=0,this._l=.8,this._x=[],this._y=null}get categories(){const _=this.predict();return[...new Set(_)]}get centroids(){return this.categories.map(_=>this._x[_])}get size(){const _=this.predict();return new Set(_).size}get epoch(){return this._epoch}init(_){this._x=_;const h=_.length;this._r=Array(h),this._a=Array(h),this._ar=Array(h),this._s=Array(h),this._as=Array(h);for(let t=0;t<h;t++)this._r[t]=Array(h).fill(0),this._a[t]=Array(h).fill(0),this._ar[t]=Array(h).fill(0),this._s[t]=Array(h),this._as[t]=Array(h);this._y=null,this._epoch=0;let s=1/0;for(let t=0;t<h;t++)for(let i=0;i<t;i++){const r=-this._x[t].reduce((n,e,a)=>n+(e-this._x[i][a])**2,0);this._s[t][i]=this._s[i][t]=r,this._as[t][i]=this._as[i][t]=r,s=Math.min(s,r)}for(let t=0;t<h;t++)this._s[t][t]=this._as[t][t]=s}fit(){const h=this._x.length,s=this._l;for(let t=0;t<h;t++)for(let i=0;i<h;i++){let r=-1/0;const n=t===i?this._s[t]:this._as[t];for(let e=0;e<h;e++)i!==e&&(r=Math.max(r,n[e]));this._r[t][i]=s*this._r[t][i]+(1-s)*(this._s[t][i]-r)}for(let t=0;t<h;t++)for(let i=0;i<h;i++){let r=t===i?0:this._r[i][i];for(let e=0;e<h;e++)e!==t&&e!==i&&(r+=Math.max(0,this._r[e][i]));t!==i&&(r=Math.min(0,r));const n=s*this._a[t][i]+(1-s)*r;this._a[t][i]=n,this._ar[t][i]=n+this._r[t][i],this._as[t][i]=n+this._s[t][i]}this._y=null,this._epoch++}__fit(){const h=this._x.length;for(let s=0;s<h;s++)for(let t=0;t<h;t++){let i=0;for(let r=0;r<h;r++)r!==t&&(i+=this._a[s][r]*this._s[s][r]);this._r[s][t]=this._s[s][t]/i}for(let s=0;s<h;s++){let t=1;for(let i=0;i<h;i++)i!==s&&(t*=1+this._r[i][s]);this._a[s][s]=t-1,this._ar[s][s]=this._a[s][s]+this._r[s][s];for(let i=0;i<h;i++)if(s!==i){t=1/this._r[s][s]-1;for(let r=0;r<h;r++)r===s||r===i||(t*=1/(1+this._r[r][s]));this._a[s][i]=1/(1+t),this._ar[s][i]=this._a[s][i]+this._r[s][i]}}this._y=null,this._epoch++}predict(){if(!this._y){this._y=[];const _=this._x.length;for(let h=0;h<_;h++){let s=-1/0,t=-1;for(let i=0;i<_;i++){const r=this._ar[h][i];s<r&&(s=r,t=i)}this._y.push(t)}}return this._y}}
