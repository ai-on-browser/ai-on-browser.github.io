import{Matrix}from"../util/math.js";export default class NiblackThresholding{constructor(t=3,r=.1){this._n=t,this._k=r}predict(t){const r=Math.floor(this._n/2),a=[];for(let h=0;h<t.length;h++){a[h]=[];for(let o=0;o<t[h].length;o++){const l=[];for(let a=Math.max(0,h-r);a<=Math.min(t.length-1,h+r);a++)for(let e=Math.max(0,o-r);e<=Math.min(t[h].length-1,o+r);e++)l.push(t[a][e]);const e=Matrix.fromArray(l),n=e.mean(0),s=e.std(0);s.mult(this._k),a[h][o]=n.copySub(s).value.map(((r,a)=>t[h][o][a]<r?0:255))}}return a}}