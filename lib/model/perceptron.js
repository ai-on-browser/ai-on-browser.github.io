export class Perceptron{constructor(t){this._r=t,this._a=null,this._b=0}fit(t,h){this._a||(this._a=Array(t[0].length).fill(0));for(let s=0;s<t.length;s++){const i=t[s].reduce(((t,h,s)=>t+h*this._a[s]),this._b)<=0?-1:1;if(i!==h[s]){const e=(h[s]-i)*this._r;for(let h=0;h<t[s].length;h++)this._a[h]+=e*t[s][h];this._b+=e}}}predict(t){return t.map((t=>t.reduce(((t,h,s)=>t+h*this._a[s]),this._b)<=0?-1:1))}}export class AveragedPerceptron{constructor(t){this._r=t,this._epoch=0,this._a=null,this._atotal=null,this._b=0,this._btotal=0}fit(t,h){this._a||(this._a=Array(t[0].length).fill(0),this._atotal=Array(t[0].length).fill(0)),this._epoch++;for(let s=0;s<t.length;s++){const i=t[s].reduce(((t,h,s)=>t+h*this._a[s]),this._b)<=0?-1:1;if(i!==h[s]){const e=(h[s]-i)*this._r;for(let h=0;h<t[s].length;h++)this._atotal[h]+=e*t[s][h],this._a[h]+=this._atotal[h]/this._epoch;this._btotal+=e,this._b+=this._btotal/this._epoch}}}predict(t){return t.map((t=>t.reduce(((t,h,s)=>t+h*this._a[s]),this._b)<=0?-1:1))}}export class MulticlassPerceptron{constructor(t){this._r=t,this._c=[],this._epoch=0,this._a=[],this._b=[]}fit(t,h){this._epoch++;for(let s=0;s<t.length;s++){let i=this._c.indexOf(h[s]);i<0&&(this._c.push(h[s]),this._a.push(Array(t[s].length).fill(0)),this._b.push(0),i=this._c.length-1);let e=-1/0,_=-1;for(let h=0;h<this._c.length;h++){const i=this._a[h].reduce(((h,i,e)=>h+i*t[s][e]),this._b[h]);e<i&&(e=i,_=h)}if(_!==i){for(let h=0;h<t[s].length;h++)this._a[i][h]+=t[s][h]*this._r,this._a[_][h]-=t[s][h]*this._r;this._b[i]+=this._r,this._b[_]-=this._r}}}predict(t){const h=[];for(let s=0;s<t.length;s++){let i=-1/0,e=-1;for(let h=0;h<this._c.length;h++){const _=this._a[h].reduce(((h,i,e)=>h+i*t[s][e]),this._b[h]);i<_&&(i=_,e=h)}h.push(this._c[e])}return h}}