var u=Object.defineProperty;var f=(l,i)=>u(l,"name",{value:i,configurable:!0});import a from"../util/matrix.js";export default class y{static{f(this,"Sammon")}constructor(i,_){this._x=i;const o=this._x.length;this._y=a.randn(o,_),this._alpha=.3,this._d=a.zeros(o,o);for(let s=0;s<o;s++)for(let h=s+1;h<o;h++){let e=0;for(let t=0;t<i[s].length;t++)e+=(i[s][t]-i[h][t])**2;e=Math.sqrt(e),this._d.set(s,h,e),this._d.set(h,s,e)}}fit(){const i=this._d.sum(),_=this._y.rows,o=this._y.cols;for(let s=0;s<_;s++){const h=a.zeros(1,o),e=a.zeros(1,o);for(let t=0;t<_;t++){if(s===t)continue;let r=0;for(let n=0;n<o;n++)r+=(this._y.at(s,n)-this._y.at(t,n))**2;if(r=Math.sqrt(r),r===0)continue;const c=(this._d.at(s,t)-r)/(this._d.at(s,t)*r),d=a.sub(this._y.row(s),this._y.row(t));h.sub(a.mult(d,2/i*c)),e.sub(a.map(d,n=>2/i*c*(1-n**2/r*(1/(this._d.at(s,t)-r)+1/r))))}for(let t=0;t<o;t++)this._y.subAt(s,t,this._alpha*h.at(0,t)/Math.abs(e.at(0,t)))}return this._y.toArray()}predict(){return this._y.toArray()}}
