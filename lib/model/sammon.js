var u=Object.defineProperty;var f=(d,r)=>u(d,"name",{value:r,configurable:!0});import n from"../util/matrix.js";export default class y{static{f(this,"Sammon")}constructor(r){this._rd=r}init(r){this._x=r;const h=this._x.length;this._y=n.randn(h,this._rd),this._alpha=.3,this._d=n.zeros(h,h);for(let i=0;i<h;i++)for(let t=i+1;t<h;t++){let e=0;for(let a=0;a<r[i].length;a++)e+=(r[i][a]-r[t][a])**2;e=Math.sqrt(e),this._d.set(i,t,e),this._d.set(t,i,e)}}fit(){const r=this._d.sum(),h=this._y.rows,i=this._y.cols;for(let t=0;t<h;t++){const e=n.zeros(1,i),a=n.zeros(1,i);for(let s=0;s<h;s++){if(t===s)continue;let o=0;for(let _=0;_<i;_++)o+=(this._y.at(t,_)-this._y.at(s,_))**2;if(o=Math.sqrt(o),o===0)continue;const l=(this._d.at(t,s)-o)/(this._d.at(t,s)*o),c=n.sub(this._y.row(t),this._y.row(s));e.sub(n.mult(c,2/r*l)),a.sub(n.map(c,_=>2/r*l*(1-_**2/o*(1/(this._d.at(t,s)-o)+1/o))))}for(let s=0;s<i;s++)this._y.subAt(t,s,this._alpha*e.at(0,s)/Math.abs(a.at(0,s)))}return this._y.toArray()}predict(){return this._y.toArray()}}
