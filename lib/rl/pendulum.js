var M=Object.defineProperty;var _=(n,t)=>M(n,"name",{value:t,configurable:!0});import{RLEnvironmentBase as x,RLRealRange as a,RLStepResult as g}from"./base.js";export default class w extends x{static{_(this,"PendulumRLEnvironment")}constructor(){super(),this._theta=0,this._dtheta=0,this._mass=1,this._length=1,this._max_speed=8,this._max_torque=2,this._g=9.8,this._dt=.05,this._max_step=200}get actions(){return[new a(-this._max_torque,this._max_torque)]}get states(){return[new a(-1,1),new a(-1,1),new a(-this._max_speed,this._max_speed)]}reset(){return super.reset(),this._theta=Math.random()*2*Math.PI-Math.PI,this._dtheta=Math.random()-.5,this.state()}state(){return[Math.cos(this._theta),Math.sin(this._theta),this._dtheta]}setState(t){this._theta=Math.atan2(t[1],t[0]),this._dtheta=t[2]}test(t,s){let h=Math.atan2(t[1],t[0]),e=t[2];const r=_((i,d,u)=>i<d?d:i>u?u:i,"clip"),o=r(s[0],-this._max_torque,this._max_torque),l=this._g,c=this._mass,m=this._length,p=this._angle_normalize(h)**2+.1*e**2+.001*o**2;return e+=(-3*l/(2*m)*Math.sin(h+Math.PI)+3/(c*m**2)*o)*this._dt,h+=e*this._dt,e=r(e,-this._max_speed,this._max_speed),new g(this,[Math.cos(h),Math.sin(h),e],-p,this.epoch>=this._max_step)}_angle_normalize(t){t+=Math.PI;const s=2*Math.PI;for(;t<0;)t+=s;for(;t>=s;)t-=s;return t-Math.PI}}
