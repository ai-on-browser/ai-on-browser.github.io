export class BaseData{constructor(t){this._x=[],this._y=[],this._manager=t}get setting(){return this._manager.setting}get svg(){return this._manager.setting.svg}get availTask(){return[]}get dimension(){return this.domain.length}get domain(){if(0===this.length)return[];const t=[];for(let e=0;e<this.x[0].length;e++)t.push([1/0,-1/0]);for(const e of this.x)if(!Array.isArray(e[0]))for(let s=0;s<e.length;s++)t[s][0]=Math.min(t[s][0],e[s]),t[s][1]=Math.max(t[s][1],e[s]);return t}get range(){const t=[1/0,-1/0];for(const e of this.y)t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],e);return t}get categories(){return[...new Set(this.y)]}get length(){return this.x.length}get x(){return this._x}get series(){return{values:this.x,get domain(){if(0===this.values.length)return[];const t=[];for(let e=0;e<this.values[0].length;e++)t.push([1/0,-1/0]);for(const e of this.values)for(let s=0;s<e.length;s++)t[s][0]=Math.min(t[s][0],e[s]),t[s][1]=Math.max(t[s][1],e[s]);return t}}}get y(){return this._y}get points(){return this._manager.platform._renderer.points}get scale(){return 1}set scale(t){}get isSeries(){const t=this.setting.vue.mlTask;return["TP","SM","CP"].indexOf(t)>=0}get selectedColumnIndex(){return this.isSeries?[Math.min(1,this.dimension-1)]:1===this.dimension?[0]:[0,1]}get params(){return{}}set params(t){}*[Symbol.iterator](){const t=this.length;for(let e=0;e<t;e++)yield this.at(e)}splice(t,e,...s){return[]}set(t,e,s){this.splice(t,1,e,s)}push(...t){this.splice(this.length,0,...t)}pop(){return this.splice(this.length-1,1)[0]}unshift(...t){this.splice(0,0,...t)}shift(){return this.splice(0,1)[0]}slice(t,e){const s=[];for(let n=t;n<e;n++)s.push(this.at(n));return s}forEach(t){const e=this.length;for(let s=0;s<e;s++)t(this.at(s),s,this)}map(t){const e=this.length,s=[];for(let n=0;n<e;n++)s.push(t(this.at(n),n,this));return s}swap(t,e){[this._x[t],this._x[e]]=[this._x[e],this._x[t]],[this._y[t],this._y[e]]=[this._y[e],this._y[t]]}sort(t){const e=this.length,s=[];for(let n=0;n<e;n++){s[n]=this.at(n);for(let e=n;e>0;e--)t(s[e-1],s[e])>0&&this.swap(e-1,e)}}remove(){this.splice(0,this.length)}terminate(){this.setting.data.configElement.selectAll("*").remove(),this.remove()}}export class MultiDimensionalData extends BaseData{constructor(t){super(t),this._categorical_output=!1,this._output_category_names=null,this._select=null}get selectedColumnIndex(){return this._select?.()??super.selectedColumnIndex}_make_selector(t){let e=this.setting.data.configElement.select("div.column-selector");if(0===e.size()?e=this.setting.data.configElement.append("div").classed("column-selector",!0):e.selectAll("*").remove(),this.dimension<=2)this._select=null;else if(this.dimension<=4){const s=e.append("table").style("border-collapse","collapse");let n=s.append("tr").style("text-align","center");n.append("td"),n.append("td").text(">"),n.append("td").text("V").style("transform","rotate(180deg");const i=[],r=[];for(let e=0;e<this.dimension;e++){n=s.append("tr"),s.append("td").text(t[e]).style("text-align","right");const a=s.append("td").append("input").attr("type","radio").attr("name","data-d1").on("change",(()=>this._manager.platform.render()));i.push(a);const o=s.append("td").append("input").attr("type","radio").attr("name","data-d2").on("change",(()=>this._manager.platform.render()));r.push(o)}i[0].property("checked",!0),r[1].property("checked",!0),this._select=()=>{const t=[];for(let e=0;e<this.dimension;e++)i[e].property("checked")&&(t[0]=e),r[e].property("checked")&&(t[1]=e);return t}}else{t=t.map((t=>""+t)),e.append("span").text(">");const s=e.append("select").on("change",(()=>this._manager.platform.render()));s.selectAll("option").data(t).enter().append("option").attr("value",(t=>t)).text((t=>t)),s.property("value",t[0]),e.append("span").text("V").style("transform","rotate(180deg").style("display","inline-block");const n=e.append("select").on("change",(()=>this._manager.platform.render()));n.selectAll("option").data(t).enter().append("option").attr("value",(t=>t)).text((t=>t)),n.property("value",t[1]),this._select=()=>[t.indexOf(s.property("value")),t.indexOf(n.property("value"))]}this._manager.platform.render()}terminate(){this.setting.data.configElement.select("div.column-selector").remove(),super.terminate()}}export class FixData extends MultiDimensionalData{constructor(t){super(t),this._domain=null}get domain(){return this._domain?this._domain:this._domain=super.domain}at(t){return Object.defineProperties({},{x:{get:()=>this._x[t]},y:{get:()=>this._y[t]},point:{get:()=>this.points[t]}})}}