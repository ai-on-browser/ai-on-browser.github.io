var u=Object.defineProperty;var h=(o,e)=>u(o,"name",{value:e,configurable:!0});import{FixData as d}from"./base.js";class y{static{h(this,"JSONLoader")}constructor(e){this._data=e}get data(){return this._data}async load(e){if(e instanceof File){await new Promise(r=>{const i=new FileReader;i.onload=()=>{this._data=JSON.parse(i.result),r()},i.readAsText(e)});return}const t=await fetch(e);this._data=await t.json()}}export default class N extends d{static{h(this,"JSONData")}constructor(e,t,r){super(e),t&&r&&this.setJSON(t,r)}async readJSON(e){return new Promise(t=>{const r=new y(null);r.load(e).then(()=>t(r.data))})}setJSON(e,t){if(!Array.isArray(e)){this.readJSON(e).then(a=>{this.setJSON(a,t)});return}const r=[];if(t)for(let a=0;a<t.length;a++)r[a]=t[a].name;const i=[],l=[];for(let a=0;a<e.length;a++){const n=[];for(const s of Object.keys(e[a])){let c=r.indexOf(s);c<0&&(r.push(s),c=r.length-1,l[c]=!1),n[c]=e[a][s],l[c]||=isNaN(n[c])}if(t)for(let s=0;s<t.length;s++)n[s]==null&&typeof t[s].nan=="number"&&(n[s]=t[s].nan);i[a]=n}t||(t=r.map((a,n)=>({name:a,type:l[n]?"category":"numeric"})),t[t.length-1].out=!0),this.setArray(i,t)}}
