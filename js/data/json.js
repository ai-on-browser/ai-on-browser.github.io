import CSVData from"./csv.js";class JSONLoader{constructor(t){this._data=t}get data(){return this._data}async load(t){if(t instanceof File)return void await new Promise((e=>{const a=new FileReader;a.onload=()=>{this._data=JSON.parse(a.result),e()},a.readAsText(t)}));const e=await fetch(t);this._data=await e.json()}}export default class JSONData extends CSVData{constructor(t,e,a){super(t),this._input_category_names=[],this._output_category_names=null,e&&a&&this.setJSON(e,a)}readJSON(t,e){const a=new JSONLoader(null);a.load(t).then((()=>e(a.data)))}setJSON(t,e){if(!Array.isArray(t))return void this.readJSON(t,(t=>{this.setJSON(t,e)}));const a=[];if(e)for(let t=0;t<e.length;t++)a[t]=e[t].name;const s=[],n=[];for(let e=0;e<t.length;e++){const o=[];for(const s of Object.keys(t[e])){let r=a.indexOf(s);r<0&&(a.push(s),r=a.length-1,n[r]=!1),o[r]=t[e][s],n[r]||=isNaN(o[r])}s[e]=o}e||((e=a.map(((t,e)=>({name:t,type:n[e]?"category":"numeric"}))))[e.length-1].out=!0),this.setCSV(s,e)}}