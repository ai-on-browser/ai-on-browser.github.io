var n=Object.defineProperty;var c=(l,t)=>n(l,"name",{value:t,configurable:!0});import{EventEmitter as r}from"../../utils.js";export default class h{static{c(this,"IOSelector")}constructor(t){this._r=t.appendChild(document.createElement("div")),this._columns=[],this._object=[],this._target=-1,this._objselector=null,this._tarselector=null,this._emitter=new r}get object(){return this._object}get objectNames(){return this._object.map(t=>this._columns[t])}set object(t){if(this._object=t.concat(),this._objselector){for(const e of this._objselector.options)e.selected=!1;for(let e=0;e<t.length;e++)this._objselector.options.item(t[e]).selected=!0}}get target(){return this._target}get targetName(){return this._columns[this._target]}set target(t){this._target=t,this._tarselector&&(this._tarselector.options.item(t+1).selected=!0)}set columns(t){this._columns=t,this._readySelector()}set onchange(t){this._emitter.on("change",t)}_readySelector(){if(this._r.replaceChildren(),this._columns.length>1){const t=this._objselector=document.createElement("select");t.multiple=!0,t.onchange=()=>{this._object=[];let s="",i=!1;for(const o of t.options)o.selected?(this._object.push(this._columns.indexOf(o.value)),o.value===e.value&&(i=!0)):s||(s=o.value);i&&(this._target=this._columns.indexOf(s),e.value=s),this._emitter.emit("change",{object:this._object,target:this._target})},t.size=Math.min(4,this._columns.length),this._columns.length<=4&&(t.style.overflowY="hidden"),this._r.append("Input",t);const e=this._tarselector=document.createElement("select");e.onchange=()=>{let s=!1;for(const i of t.selectedOptions)if(i.value===e.value){i.selected=!1,this._object=this._object.filter(o=>this._columns[o]!==i.value),s=!0;break}if(s||e.value===""&&this._target>=0)for(const i of t.options)i.value===this._columns[this._target]&&(i.selected=!0,this._object.push(this._target));this._target=this._columns.indexOf(e.value),this._emitter.emit("change",{object:this._object,target:this._target})},this._r.append("Output",e),e.appendChild(document.createElement("option"));for(const s of this._columns){const i=document.createElement("option");i.value=i.innerText=s,t.appendChild(i),e.appendChild(i.cloneNode(!0))}t.size=Math.min(4,t.options.length);for(let s=0;s<this._columns.length-1;s++)t.options[s].selected=this._object.includes(s);e.value=this._columns[this._target]}}clear(){this._r.replaceChildren(),this._columns=[],this._object=[],this._target=-1}terminate(){this._r.remove()}}
