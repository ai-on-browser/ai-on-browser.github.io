class RNNWorker extends BaseWorker{constructor(){super("js/view/worker/rnn_worker.js",{type:"module"})}initialize(t,e,a,n,r,p){this._postMessage({mode:"init",method:t,window:e,unit:a,out_size:n,optimizer:r},p)}fit(t,e,a,n,r,p){this._postMessage({mode:"fit",x:t,y:e,iteration:a,rate:n,batch:r},p)}predict(t,e,a){this._postMessage({mode:"predict",x:t,k:e},a)}}var dispRNN=function(t,e){const a=new RNNWorker;let n=0;t.append("select").attr("name","method").selectAll("option").data(["rnn","LSTM","GRU"]).enter().append("option").property("value",(t=>t.toLowerCase())).text((t=>t)),t.append("span").text("window width"),t.append("input").attr("type","number").attr("name","width").attr("min",1).attr("max",1e3).attr("value",30);const r=e.setting.ml.controller.stepLoopButtons().init((()=>{if(0===e.datas.length)return;const n=t.select("[name=method]").property("value"),r=+t.select("[name=width]").property("value");e.fit(((t,e)=>{a.initialize(n,r,3,t[0].length)})),e.init()}));return t.append("span").text(" Iteration "),t.append("select").attr("name","iteration").selectAll("option").data([1,10,100,1e3,1e4]).enter().append("option").property("value",(t=>t)).text((t=>t)),t.append("span").text(" Learning rate "),t.append("input").attr("type","number").attr("name","rate").attr("min",0).attr("max",100).attr("step",.01).attr("value",.001),t.append("span").text(" Batch size "),t.append("input").attr("type","number").attr("name","batch").attr("value",10).attr("min",1).attr("max",100).attr("step",1),r.step((r=>{const p=+t.select("[name=iteration]").property("value"),i=+t.select("[name=batch]").property("value"),o=+t.select("[name=rate]").property("value"),s=+t.select("[name=pred_count]").property("value");e.fit(((t,e,l)=>{a.fit(t,t,p,o,i,(e=>{n=e.data.epoch,a.predict(t,s,(t=>{const e=t.data;l(e),r&&r()}))}))}))})).epoch((()=>n)),t.append("span").text(" predict count"),t.append("input").attr("type","number").attr("name","pred_count").attr("min",1).attr("max",1e3).attr("value",100),()=>{a.terminate()}};export default function(t){t.setting.ml.usage='Click and add data point. Next, click "Initialize". Finally, click "Fit" button repeatedly.',t.setting.ternimate=dispRNN(t.setting.ml.configElement,t)}