var m=Object.defineProperty;var r=(t,e)=>m(t,"name",{value:e,configurable:!0});import h from"../controller.js";import{BaseWorker as v}from"../utils.js";class g extends v{static{r(this,"W2VWorker")}constructor(){super("js/view/worker/word2vec_worker.js",{type:"module"})}initialize(e,i,n,s,o){return this._postMessage({mode:"init",method:e,n:i,wordsOrNumber:n,reduce_size:s,optimizer:o})}fit(e,i,n,s){return this._postMessage({mode:"fit",words:e,iteration:i,rate:n,batch:s})}predict(e){return this._postMessage({mode:"predict",x:e})}reduce(e){return this._postMessage({mode:"reduce",x:e}).then(i=>i.data)}}export default function k(t){t.setting.ml.usage='Click and add data point. Next, click "Initialize". Finally, click "Fit" button repeatedly.',t.setting.ml.reference={title:"Word2vec (Wikipedia)",url:"https://en.wikipedia.org/wiki/Word2vec"};const e=new h(t),i=new g;let n=0;const s=r(async()=>{const a=await i.fit(t.trainInput,+u.value,d.value,p.value);n=a.data.epoch,t.plotLoss(a.data.loss),t.testResult(await i.reduce(t.testInput()))},"fitModel"),o=e.select(["CBOW","skip-gram"]),c=e.input.number({label:" n ",min:1,max:10,value:1}),l=e.stepLoopButtons().init(a=>{if(t.init(),t.datas.length===0){a();return}i.initialize(o.value,c.value,t.trainInput,2,"adam").then(a)}),u=e.select({label:" Iteration ",values:[1,10,100,1e3,1e4]}),d=e.input.number({label:" Learning rate ",min:0,max:100,step:.01,value:.001}),p=e.input.number({label:" Batch size ",min:1,max:100,value:10});return l.step(s).epoch(()=>n),()=>{i.terminate()}}r(k,"default");
