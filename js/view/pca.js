import{PCA,DualPCA,KernelPCA,AnomalyPCA}from"../../lib/model/pca.js";var dispPCA=function(t,e){const a=()=>{e.fit(((a,n,p)=>{if("DR"===e.task){const n=e.dimension,l=t.select("[name=kernel]").property("value"),s=t.select("[name=type]").property("value");let i;if(""===s)i=new PCA;else if("dual"===s)i=new DualPCA;else{const e=[];"polynomial"===l?e.push(+t.select("[name=poly_d]").property("value")):"gaussian"===l&&e.push(+t.select("[name=sigma]").property("value")),i=new KernelPCA(l,e)}i.fit(a);p(i.predict(a,n))}else{const n=new AnomalyPCA;n.fit(a);const l=+t.select("[name=threshold]").property("value");p(n.predict(a).map((t=>t>l))),e.predict(((t,e)=>{e(n.predict(t).map((t=>t>l)))}),10)}}))};"AD"!==e.task&&t.append("select").attr("name","type").on("change",(function(){"kernel"===d3.select(this).property("value")?n.style("display","inline-block"):n.style("display","none")})).selectAll("option").data(["","dual","kernel"]).enter().append("option").attr("value",(t=>t)).text((t=>t));const n=t.append("span").style("display","none");n.append("select").attr("name","kernel").on("change",(function(){const t=d3.select(this);p.style("display","none"),l.style("display","none"),"polynomial"===t.property("value")?p.style("display","inline-block"):"gaussian"===t.property("value")&&l.style("display","inline-block")})).selectAll("option").data(["gaussian","polynomial"]).enter().append("option").attr("value",(t=>t)).text((t=>t));const p=n.append("span").style("display","none");p.append("span").text(" d = ").append("input").attr("type","number").attr("name","poly_d").attr("value",2).attr("min",1).attr("max",10);const l=n.append("span");l.append("span").text(" sigma = ").append("input").attr("type","number").attr("name","sigma").attr("value",1).attr("min",0).attr("max",10).attr("step",.1),"AD"===e.task&&(t.append("span").text(" threshold = "),t.append("input").attr("type","number").attr("name","threshold").attr("value",.1).attr("min",0).attr("max",10).attr("step",.01).on("change",a)),t.append("input").attr("type","button").attr("value","Fit").on("click",a)};export default function(t){t.setting.ml.usage='Click and add data point. Next, click "Fit" button.',dispPCA(t.setting.ml.configElement,t)}