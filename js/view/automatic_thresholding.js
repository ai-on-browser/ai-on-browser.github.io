import AutomaticThresholding from"../../lib/model/automatic_thresholding.js";import Controller from"../controller.js";import{specialCategory}from"../utils.js";export default function(t){t.setting.ml.usage='Click "Fit" button.',t.colorSpace="gray";const o=new Controller(t);let e=null;o.stepLoopButtons().init((()=>{e=null,l.value=0})).step((o=>{const i=t._step;t._step=1,e||(e=new AutomaticThresholding),e.fit(t.trainInput.flat(2));const n=e.predict(t.trainInput.flat(2));l.value=e._th,t.trainResult=n.map((t=>specialCategory.density(1-t))),t._step=i,o&&o()})).epoch();const l=o.text({label:" Estimated threshold "})}