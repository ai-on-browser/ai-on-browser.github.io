import DBSCAN from"../../lib/model/dbscan.js";var dispDBSCAN=function(t,e){const a=e.svg;a.insert("g",":first-child").attr("class","range").attr("opacity",.4);const n=()=>{a.selectAll(".range *").remove();const n=t.select("[name=metric]").property("value"),r=+t.select("[name=eps]").property("value"),p=+t.select("[name=minpts]").property("value"),l=new DBSCAN(r,p,n).predict(e.trainInput);e.trainResult=l.map((t=>t+1)),t.select("[name=clusters]").text(new Set(l).size);const s=1e3;"euclid"===n?a.select(".range").selectAll("circle").data(e.trainInput).enter().append("circle").attr("cx",(t=>t[0]*s)).attr("cy",(t=>t[1]*s)).attr("r",r*s).attr("fill-opacity",0).attr("stroke",((t,e)=>getCategoryColor(l[e]+1))):"manhattan"===n?a.select(".range").selectAll("polygon").data(e.trainInput).enter().append("polygon").attr("points",(t=>{const e=t[0]*s,a=t[1]*s,n=r*s;return`${e-n},${a} ${e},${a-n} ${e+n},${a} ${e},${a+n}`})).attr("fill-opacity",0).attr("stroke",((t,e)=>getCategoryColor(l[e]+1))):"chebyshev"===n&&a.select(".range").selectAll("rect").data(e.trainInput).enter().append("rect").attr("x",(t=>(t[0]-r)*s)).attr("y",(t=>(t[1]-r)*s)).attr("width",2*r*s).attr("height",2*r*s).attr("fill-opacity",0).attr("stroke",((t,e)=>getCategoryColor(l[e]+1)))};t.append("select").attr("name","metric").on("change",n).selectAll("option").data(["euclid","manhattan","chebyshev"]).enter().append("option").attr("value",(t=>t)).text((t=>t)),t.append("span").text("eps"),t.append("input").attr("type","number").attr("name","eps").attr("min",.01).attr("max",10).attr("step",.01).attr("value",.05).on("change",n),t.append("span").text("min pts"),t.append("input").attr("type","number").attr("name","minpts").attr("min",2).attr("max",1e3).attr("value",5).on("change",n);t.append("input").attr("type","button").attr("value","Fit").on("click",n);return t.append("span").text(" Clusters: "),t.append("span").attr("name","clusters"),()=>{a.select(".range").remove()}};export default function(t){t.setting.ml.usage='Click and add data point. Then, click "Fit" button.',t.setting.terminate=dispDBSCAN(t.setting.ml.configElement,t)}