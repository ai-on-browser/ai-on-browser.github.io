var A=Object.defineProperty;var b=(n,l)=>A(n,"name",{value:l,configurable:!0});import y from"../../lib/model/dbscan.js";import f from"../controller.js";import{getCategoryColor as m}from"../utils.js";export default function C(n){n.setting.ml.usage='Click and add data point. Then, click "Fit" button.',n.setting.ml.reference={title:"DBSCAN (Wikipedia)",url:"https://en.wikipedia.org/wiki/DBSCAN"};const l=new f(n),v=n.svg,r=document.createElementNS("http://www.w3.org/2000/svg","g");v.insertBefore(r,v.firstChild),r.classList.add("range"),r.setAttribute("opacity",.4);const a=b(()=>{r.replaceChildren();const o=new y(c.value,h.value,u.value).predict(n.trainInput);n.trainResult=o.map(t=>t+1),w.value=new Set(o).size;const i=n._renderer[0].scale[0],s=n.trainInput;if(u.value==="euclid")for(let t=0;t<s.length;t++){const e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.setAttribute("cx",s[t][0]*i),e.setAttribute("cy",s[t][1]*i),e.setAttribute("r",c.value*i),e.setAttribute("fill-opacity",0),e.setAttribute("stroke",m(o[t]+1)),r.append(e)}else if(u.value==="manhattan")for(let t=0;t<s.length;t++){const e=document.createElementNS("http://www.w3.org/2000/svg","polygon"),p=s[t][0]*i,d=s[t][1]*i,g=c.value*i;e.setAttribute("points",`${p-g},${d} ${p},${d-g} ${p+g},${d} ${p},${d+g}`),e.setAttribute("fill-opacity",0),e.setAttribute("stroke",m(o[t]+1)),r.append(e)}else if(u.value==="chebyshev")for(let t=0;t<s.length;t++){const e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x",(s[t][0]-c.value)*i),e.setAttribute("y",(s[t][1]-c.value)*i),e.setAttribute("width",c.value*2*i),e.setAttribute("height",c.value*2*i),e.setAttribute("fill-opacity",0),e.setAttribute("stroke",m(o[t]+1)),r.append(e)}},"fitModel"),u=l.select(["euclid","manhattan","chebyshev"]).on("change",a),c=l.input.number({label:"eps",min:.01,max:10,step:.01,value:.05}).on("change",a),h=l.input.number({label:"min pts",min:2,max:1e3,value:5}).on("change",a);l.input.button("Fit").on("click",a);const w=l.text({label:" Clusters: "});n.setting.terminate=()=>{r.remove()}}b(C,"default");
