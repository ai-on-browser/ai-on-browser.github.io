import Matrix from"../../lib/util/matrix.js";import CRF from"../../lib/model/crf.js";import Controller from"../controller.js";var dispCRF=function(t,e){const a=new Controller(e);let n=null,r=0;t.append("span").text(" discrete = "),t.append("input").attr("type","number").attr("name","discrete").attr("value",10).attr("min",2).attr("max",100);const i=a.stepLoopButtons().init((()=>{n=null,e.init()}));t.append("span").text(" iteration "),t.append("input").attr("type","number").attr("name","iteration").attr("value",1).attr("min",1).attr("max",1e3),i.step((function(a){let i=e.trainInput;const o=+t.select("[name=discrete]").property("value"),p=+t.select("[name=iteration]").property("value");n||(n=new CRF);const l=Matrix.fromArray(i),m=l.max(),s=l.min();i=i.map((t=>t.map((t=>Math.floor((t-s)/(m-s)*o)))));for(let t=0;t<p;t++)n.fit(i,e.trainOutput.map((t=>Array(l.cols).fill(t[0]))));r+=p;const c=e.testInput(10).map((t=>t.map((t=>Math.floor((t-s)/(m-s)*o))))),u=n.predict(c);e.testResult(u.map((t=>t[0]??-1))),a&&a()})).epoch((()=>r))};export default function(t){t.setting.ml.usage='Click and add data point. Then, click "Calculate".',dispCRF(t.setting.ml.configElement,t)}