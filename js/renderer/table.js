var c=Object.defineProperty;var d=(l,e)=>c(l,"name",{value:e,configurable:!0});import f from"./base.js";export default class _ extends f{static{d(this,"TableRenderer")}constructor(e){super(e),this._offset=0,this._pagesize=100,this._predict=null;const i=this.setting.render.addItem("table"),a=document.createElement("div");a.style.display="flex",a.style.justifyContent="space-between",a.style.position="sticky",a.style.top="0";const n=document.createElement("div");n.style.backgroundColor="white",n.style.padding="5px",n.style.marginBottom="-1px",n.style.borderBottom="1px solid black",a.append(n),this._navigator=document.createElement("span"),n.appendChild(this._navigator);const t=document.createElement("select");t.onchange=()=>{this._offset=0,this._pagesize=+t.value,this._renderPager()};for(const r of[10,50,100,500,1e3]){const o=document.createElement("option");o.value=r,o.innerText=r,t.append(o)}t.value=this._pagesize,n.appendChild(t);const s=document.createElement("button");s.innerHTML="&uarr;",s.onclick=()=>{window.scroll({top:0,behavior:"smooth"})},s.title="To top",s.style.margin="5px",s.style.borderRadius="50%",a.appendChild(s),this._table=document.createElement("table"),this._table.style.border="1px solid black",this._table.style.borderCollapse="collapse",i.append(a,this._table)}set trainResult(e){this._manager.platform.task==="CF"&&this.datas.outputCategoryNames?e=e.map(i=>this.datas.outputCategoryNames[i-1]):this._manager.platform.task==="AD"&&(e=e.map(i=>i?"anomalous":"")),this._predict?(this._predict=e,this._renderData()):(this._predict=e,this.render())}init(){this._predict=null}render(){this._table.replaceChildren(),this._navigator.replaceChildren(),this._offset=0;const e=this.datas;if(!e)return;const i=e.columnNames;if(i){const n=this._table.createTHead().insertRow(),t=[];e.index&&t.push("index"),t.push(...i);const s=e.originalY;s&&s.length>0&&t.push("target"),this._predict&&t.push("predict");for(const r of t){const o=document.createElement("th");o.innerText=r,o.style.border="1px solid black",n.appendChild(o)}}this._table.createTBody(),this._renderPager()}_renderPager(){this._navigator.replaceChildren(),this._renderData();const e=this.datas;if(!e)return;const i=Math.ceil(e.length/this._pagesize),a=Math.floor(this._offset/this._pagesize)+1;if(a>1){const t=document.createElement("input");t.type="button",t.value="<",t.onclick=()=>{this._offset=Math.max(0,this._offset-this._pagesize),this._renderPager()},this._navigator.appendChild(t)}const n=document.createElement("input");n.type="button",n.value="1",n.onclick=()=>{this._offset=0,this._renderPager()},a===1&&(n.disabled=!0),this._navigator.appendChild(n),a>3&&this._navigator.append(" ... ");for(let t=Math.max(2,a-1);t<=Math.min(i-1,a+1);t++){const s=document.createElement("input");s.type="button",s.value=t,s.onclick=()=>{this._offset=this._pagesize*(t-1),this._renderPager()},t===a&&(s.disabled=!0),this._navigator.appendChild(s)}if(a<i-2&&this._navigator.append(" ... "),i>1){const t=document.createElement("input");t.type="button",t.value=i,t.onclick=()=>{this._offset=this._pagesize*(i-1),this._renderPager()},a===i&&(t.disabled=!0),this._navigator.appendChild(t)}if(a<i){const t=document.createElement("input");t.type="button",t.value=">",t.onclick=()=>{this._offset=Math.min(e.length-1,this._offset+this._pagesize),this._renderPager()},this._navigator.appendChild(t)}this._navigator.append(` (${this._offset+1} - ${Math.min(this._offset+this._pagesize,e.length)} / ${e.length}) `)}_renderData(){const e=this._table.tBodies[0];e.replaceChildren();const i=this.datas;if(!i)return;const a=i.originalX,n=this._manager.platform.task==="RG"?i.y:i.originalY,t=i.index;for(let s=this._offset;s<Math.min(i.length,this._offset+this._pagesize);s++){const r=e.insertRow(),o=[];t&&o.push(t[s]),a[s]&&o.push(...a[s]),n&&n.length>0&&o.push(n[s]),this._predict&&o.push(this._predict[s]);for(const p of o){const h=r.insertCell();h.innerText=p,h.style.border="1px solid black"}}}terminate(){this.setting.render.removeItem("table"),super.terminate()}}
