var x=Object.defineProperty;var g=(c,e)=>x(c,"name",{value:e,configurable:!0});import f from"./base.js";import y from"../data/loader/document.js";export default class C extends f{static{g(this,"DocumentScatterRenderer")}constructor(e){super(e),this._size=[960,500];const o=this.setting.render.addItem("document-scatter"),i=document.createElement("div");if(i.id="plot-area",o.appendChild(i),this._root=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._root.style.border="1px solid #000000",this._root.setAttribute("width",`${this._size[0]}px`),this._root.setAttribute("height",`${this._size[1]}px`),i.appendChild(this._root),this._svg=document.createElementNS("http://www.w3.org/2000/svg","g"),this._root.appendChild(this._svg),this._r=this._svg.querySelector("g.points g.datas"),!this._r){const s=document.createElementNS("http://www.w3.org/2000/svg","g");s.classList.add("points"),this._svg.appendChild(s),this._r=document.createElementNS("http://www.w3.org/2000/svg","g"),this._r.classList.add("datas"),s.appendChild(this._r)}}get svg(){return this._svg}set trainResult(e){this._pred=e,this._displayResults(e,this.trainInput)}init(){this._lastpred=null,this._r_tile?.remove()}_render(){}testData(){const e=this.datas.x[0],[o,i]=y.ordinal(e);return o}testResult(e){this._pred=e,this._displayResults(e,this.testData())}_displayResults(e,o){this._r.replaceChildren();let i=[],s=[];for(let t=0;t<e[0].length;t++){const r=e.map(n=>n[t]);i.push(Math.max(...r)),s.push(Math.min(...r))}const u=this._size[0],w=this._size[1]-20,a=[u,w],h=a.map((t,r)=>(t-10)/(i[r]-s[r])),d=Math.min(...h),l=[5,20];for(let t=0;t<h.length;t++)h[t]>d&&(isFinite(h[t])?l[t]+=(h[t]-d)*(i[t]-s[t])/2:l[t]=a[t]/2-s[t]);for(let t=0;t<e.length;t++){const r=e[t].map((v,p)=>{const _=(v-s[p])*d+l[p];return isFinite(_)?_:a[p]/2}),n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("x",r[0]),n.setAttribute("y",r[1]??a[1]/2),n.innerHTML=o[t];const m=document.createElementNS("http://www.w3.org/2000/svg","title");m.innerHTML=o[t],n.appendChild(m),this._r.appendChild(n)}}terminate(){this.setting.render.removeItem("document-scatter"),super.terminate()}}
