var l=Object.defineProperty;var n=(r,t)=>l(r,"name",{value:t,configurable:!0});export class BaseWorker{static{n(this,"BaseWorker")}constructor(t,e){this._worker=new Worker(t,e)}_postMessage(t){const e=new Promise(s=>{const o=n(c=>{this._worker.removeEventListener("message",o,!1),s(c)},"event_cb");this._worker.addEventListener("message",o,!1)});return this._worker.postMessage(t),e}terminate(){this._worker.terminate()}}const a=n((r,t,e)=>({r,g:t,b:e,toString(){return`rgb(${r}, ${t}, ${e})`}}),"rgb"),i={"-2":a(255,0,0),"-1":a(255,255,255),0:a(0,0,0)};export const specialCategory={error:-2,errorRate:n(r=>-1-r,"errorRate"),dummy:-2,density:n(r=>-1+r,"density"),never:-3},getCategoryColor=n(r=>{if(Number.isNaN(+r))return i[0];if(!Number.isInteger(r)){const t=getCategoryColor(Math.floor(r)),e=getCategoryColor(Math.ceil(r)),s=r-Math.floor(r);return a(Math.round(t.r+(e.r-t.r)*s),Math.round(t.g+(e.g-t.g)*s),Math.round(t.b+(e.b-t.b)*s))}if(r=r%1e3,!i[r]){let t=0;for(;;){t+=1;const e=[Math.random(),Math.random(),Math.random()];if(e.every(o=>o>.8))continue;let s=1/0;for(const o of Object.keys(i)){if(+o<0||Math.abs(+o-r)>10)continue;const c=(e[0]-i[o].r/256)**2+(e[1]-i[o].g/256)**2+(e[2]-i[o].b/256)**2;c<s&&(s=c)}if(Math.random()-t/200<Math.sqrt(s/3)){i[r]=a(Math.floor(e[0]*256),Math.floor(e[1]*256),Math.floor(e[2]*256));break}}}return i[r]},"getCategoryColor");export class EventEmitter{static{n(this,"EventEmitter")}constructor(){this._listeners={}}on(t,e,s=!1){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push({cb:e,once:s})}once(t,e){this.on(t,e,!0)}emit(t,...e){const s=this._listeners[t];if(s)for(let o=s.length-1;o>=0;o--)s[o].cb(...e),s[o].once&&s.splice(o,1)}off(t,e){const s=this._listeners[t];if(s)for(let o=s.length-1;o>=0;o--)s[o].cb===e&&s.splice(o,1)}}
