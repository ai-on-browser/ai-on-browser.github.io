export class BaseWorker{constructor(r,o){this._worker=new Worker(r,o)}_postMessage(r){const o=new Promise((r=>{const o=e=>{this._worker.removeEventListener("message",o,!1),r(e)};this._worker.addEventListener("message",o,!1)}));return this._worker.postMessage(r),o}terminate(){this._worker.terminate()}}const rgb=(r,o,e)=>({r:r,g:o,b:e,toString:()=>`rgb(${r}, ${o}, ${e})`}),categoryColors={"-2":rgb(255,0,0),"-1":rgb(255,255,255),0:rgb(0,0,0)};export const specialCategory={error:-2,errorRate:r=>-1-r,dummy:-2,density:r=>-1+r,never:-3};export const getCategoryColor=function(r){if(isNaN(r))return categoryColors[0];if(!Number.isInteger(r)){let o=getCategoryColor(Math.floor(r)),e=getCategoryColor(Math.ceil(r)),t=r-Math.floor(r);return rgb(Math.round(o.r+(e.r-o.r)*t),Math.round(o.g+(e.g-o.g)*t),Math.round(o.b+(e.b-o.b)*t))}if(!categoryColors[r%=1e3]){let o=0;for(;;){o+=1;const e=[Math.random(),Math.random(),Math.random()];if(e.every((r=>r>.8)))continue;let t=1/0;for(const o of Object.keys(categoryColors)){if(+o<0||Math.abs(+o-r)>10)continue;const a=(e[0]-categoryColors[o].r/256)**2+(e[1]-categoryColors[o].g/256)**2+(e[2]-categoryColors[o].b/256)**2;a<t&&(t=a)}if(Math.random()-o/200<Math.sqrt(t/3)){categoryColors[r]=rgb(Math.floor(256*e[0]),Math.floor(256*e[1]),Math.floor(256*e[2]));break}}}return categoryColors[r]};