var c=Object.defineProperty;var i=(r,e)=>c(r,"name",{value:e,configurable:!0});export class BaseWorker{static{i(this,"BaseWorker")}constructor(e,t){this._worker=new Worker(e,t)}_postMessage(e){const t=new Promise(s=>{const o=i(l=>{this._worker.removeEventListener("message",o,!1),s(l)},"event_cb");this._worker.addEventListener("message",o,!1)});return this._worker.postMessage(e),t}terminate(){this._worker.terminate()}}const a=i((r,e,t)=>({r,g:e,b:t,toString(){return`rgb(${r}, ${e}, ${t})`}}),"rgb"),n={"-2":a(255,0,0),"-1":a(255,255,255),0:a(0,0,0)};export const specialCategory={error:-2,errorRate:r=>-1-r,dummy:-2,density:r=>-1+r,never:-3},getCategoryColor=i(function(r){if(isNaN(r))return n[0];if(!Number.isInteger(r)){let e=getCategoryColor(Math.floor(r)),t=getCategoryColor(Math.ceil(r)),s=r-Math.floor(r);return a(Math.round(e.r+(t.r-e.r)*s),Math.round(e.g+(t.g-e.g)*s),Math.round(e.b+(t.b-e.b)*s))}if(r=r%1e3,!n[r]){let e=0;for(;;){e+=1;const t=[Math.random(),Math.random(),Math.random()];if(t.every(o=>o>.8))continue;let s=1/0;for(const o of Object.keys(n)){if(+o<0||Math.abs(+o-r)>10)continue;const l=(t[0]-n[o].r/256)**2+(t[1]-n[o].g/256)**2+(t[2]-n[o].b/256)**2;l<s&&(s=l)}if(Math.random()-e/200<Math.sqrt(s/3)){n[r]=a(Math.floor(t[0]*256),Math.floor(t[1]*256),Math.floor(t[2]*256));break}}}return n[r]},"getCategoryColor");export class EventEmitter{static{i(this,"EventEmitter")}constructor(){this._listeners={}}on(e,t,s=!1){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push({cb:t,once:s})}once(e,t){this.on(e,t,!0)}emit(e){const t=this._listeners[e];if(t)for(let s=t.length-1;s>=0;s--)t[s].cb(),t[s].once&&t.splice(s,1)}off(e,t){const s=this._listeners[e];if(s)for(let o=s.length-1;o>=0;o--)s[o]===t&&s.splice(o,1)}}
